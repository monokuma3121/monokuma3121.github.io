<!-- build time:Tue Jul 11 2023 18:08:15 GMT+0800 (香港标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="theme-color" content="#202020"><meta http-equiv="x-ua-compatible" content="ie=edge"><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><meta name="keywords" content="axios二次封装,"><meta name="description" content="axios二次封装"><link rel="icon" type="image/x-icon" href="/logo.png"><title>axios二次封装 [ Eucli ]</title><link rel="stylesheet" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" href="/css/xoxo.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div class="nav-container"><nav class="home-menu pure-menu pure-menu-horizontal"><a class="pure-menu-heading" href="/"><img class="avatar" src="https://eucli.top/images/logo.png"> <span class="title">Eucli</span></a><ul class="pure-menu-list clearfix"><li class="pure-menu-item"><a href="/" class="pure-menu-link">首页</a></li><li class="pure-menu-item"><a href="/archives" class="pure-menu-link">归档</a></li><li class="pure-menu-item"><a href="/tags" class="pure-menu-link">标签</a></li><li class="pure-menu-item"><a href="/search" class="pure-menu-link">搜索</a></li><li class="pure-menu-item"><a target="_blank" rel="noopener" href="https://0xff000000.com" class="pure-menu-link">关于</a></li><li class="pure-menu-item"><a href="/atom.xml" class="pure-menu-link">订阅</a></li></ul></nav></div><div class="container" id="content-outer"><div class="inner" id="content-inner"><div class="post-container"><article class="post" id="post"><header class="post-header text-center"><h1 class="title">axios二次封装</h1><span><time class="time" datetime="2023-04-14T12:58:34.000Z">2023-04-14 </time></span><span class="slash">/</span> <span class="post-meta"><span class="post-tags"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/axios%E4%BA%8C%E6%AC%A1%E5%B0%81%E8%A3%85/" rel="tag">axios二次封装</a></li></ul></span></span><span class="slash">/</span> <span class="read"><span id="busuanzi_value_page_pv"></span> 点击</span></header><div class="post-content"><h1 id="前端-后端-数据库间的数据传输"><a class="markdownIt-Anchor" href="#前端-后端-数据库间的数据传输">#</a> 前端 - 后端 - 数据库间的数据传输</h1><p><img src="https://eucli-1314359160.cos.ap-beijing.myqcloud.com/test/%E6%95%B0%E6%8D%AE%E4%BA%A4%E4%BA%92.png" alt="(数据交互)"></p><h1 id="前端请求流程"><a class="markdownIt-Anchor" href="#前端请求流程">#</a> 前端请求流程</h1><p><img src="https://eucli-1314359160.cos.ap-beijing.myqcloud.com/test/%E6%8B%BF%E5%88%B0%E6%8E%A5%E5%8F%A3%E6%96%87%E6%A1%A3.png" alt="(前端请求流程)"></p><h1 id="不进行封装直接使用-axios-一般有两种方式"><a class="markdownIt-Anchor" href="#不进行封装直接使用-axios-一般有两种方式">#</a> 不进行封装直接使用 axios 一般有两种方式：</h1><h2 id="1-axiosget-axiospost"><a class="markdownIt-Anchor" href="#1-axiosget-axiospost">#</a> 1. <code>axios.get()</code> 、 <code>axios.post()</code></h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">axios.<span class="title function_">get</span>(<span class="string">&quot;url?参数1=值&amp;参数2=值&quot;</span>);</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">axios.<span class="title function_">post</span>(<span class="string">&#x27;url&#x27;</span>,&#123;</span><br><span class="line">  参数<span class="number">1</span>:值，</span><br><span class="line">  参数<span class="number">2</span>:值</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="2-axios"><a class="markdownIt-Anchor" href="#2-axios">#</a> 2. <code>axios(&#123;&#125;)</code></h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">axios</span>(&#123;</span><br><span class="line">  <span class="attr">url</span>: <span class="string">&quot;请求的路径&quot;</span>,</span><br><span class="line">  <span class="attr">method</span>: <span class="string">&quot;请求的方式，默认是get&quot;</span>,</span><br><span class="line">  <span class="attr">params</span>: &#123;&#125;, <span class="comment">//get请求方式：前端给后端传递的数据</span></span><br><span class="line">  <span class="attr">data</span>: &#123;&#125;, <span class="comment">//post请求方式：前端给后端传递的数据</span></span><br><span class="line">  <span class="attr">headers</span>: &#123;&#125;, <span class="comment">//自定义请求头</span></span><br><span class="line">  <span class="attr">timeout</span>: <span class="number">1000</span>, <span class="comment">//如果请求超过timeout的值，请求会中断</span></span><br><span class="line">  <span class="attr">responseType</span>: <span class="string">&quot;默认是json&quot;</span>, <span class="comment">// 表示浏览器将要响应的数据类型</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1 id="2-实际开发情况下的网络请求"><a class="markdownIt-Anchor" href="#2-实际开发情况下的网络请求">#</a> 2. 实际开发情况下的网络请求</h1><h1 id="实际开发中前端请求接口会出现跨域"><a class="markdownIt-Anchor" href="#实际开发中前端请求接口会出现跨域">#</a> 实际开发中，前端请求接口会出现跨域</h1><p>控制台打印 <code>CORS &quot;NO 'Access-Control-Allow-Origin' ……&quot;</code></p><h2 id="解决跨域前端解决-设置代理"><a class="markdownIt-Anchor" href="#解决跨域前端解决-设置代理">#</a> 解决跨域：前端解决 ——&gt; 设置代理</h2><p>vue 项目，在 <code>vue.config.js</code> 中配置 <code>devServer</code><br>配置参考：<a target="_blank" rel="noopener" href="https://cli.vuejs.org/zh/config">https://cli.vuejs.org/zh/config</a><br>说明：如果你的前端应用和后端 API 服务器没有运行在同一个主机上，你需要在 <code>开发环境下</code> 将 API 请求代理到 API 服务器<br>具体配置，在 <code>vue.config.js</code> 文件中加入：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">devServer</span>: &#123;</span><br><span class="line">  <span class="attr">proxy</span>: <span class="string">&quot;http://localhost:4000&quot;</span>; <span class="comment">//后端API服务器地址</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>代理之后 <code>axios</code> 请求的时候就不用写地址全拼了，直接写代理地址后面的就行</li></ul><h1 id="主要的文件"><a class="markdownIt-Anchor" href="#主要的文件">#</a> 主要的文件</h1><ul><li><code>src/utils/request.js</code> `：用于二次封装 axios</li><li><code>src/api</code> ：用于统一管理接口</li><li><code>src/.env.development</code> ：开发环境</li><li><code>src/.env.production</code> ：生产环境</li><li><code>vite.config.js</code> ：配置代理</li></ul><h2 id="前端请求接口的封装axios-二次封装"><a class="markdownIt-Anchor" href="#前端请求接口的封装axios-二次封装">#</a> 前端请求接口的封装 (axios 二次封装)</h2><p>在 <code>src/utils/request.js:</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**1.引入axios */</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**2.创建axios实例 */</span></span><br><span class="line"><span class="keyword">const</span> instance = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">  <span class="attr">baseURL</span>: <span class="string">&#x27;https://some-domain.com/api/&#x27;</span>,</span><br><span class="line">  <span class="attr">timeout</span>: <span class="number">1000</span>,</span><br><span class="line">  <span class="attr">headers</span>: &#123;<span class="string">&#x27;X-Custom-Header&#x27;</span>: <span class="string">&#x27;foobar&#x27;</span>&#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**3.请求拦截器 */</span></span><br><span class="line"><span class="comment">// 创建请求拦截  前端给后端的东西(没有到后端)</span></span><br><span class="line">instance.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function">(<span class="params">config</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">/**在发送请求之前做些什么==&gt; 判断用户登录状态 */</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> config;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**4.响应拦截器 */</span></span><br><span class="line"><span class="comment">// 创建响应拦截  后端给前端的东西</span></span><br><span class="line">instance.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> data = res.<span class="property">data</span>;</span><br><span class="line">    <span class="comment">// 处理自己的业务逻辑，比如判断 token 是否过期等等 request</span></span><br><span class="line">    <span class="comment">// 代码块</span></span><br><span class="line">    <span class="keyword">return</span> data;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> message = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(message);</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> instance;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="api-接口统一管理"><a class="markdownIt-Anchor" href="#api-接口统一管理">#</a> api 接口统一管理</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">&#x27;@/utils/request&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//查询课程接口</span></span><br><span class="line"><span class="keyword">export</span> courseSearch = <span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>(&#123;</span><br><span class="line">    <span class="attr">url</span>:<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">method</span>:<span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">    data <span class="comment">//因为不同的页面对参数配置的值的需求不一样，所以作为形参让用户自己传过来 get请求是params，post请求是data</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="使用请求"><a class="markdownIt-Anchor" href="#使用请求">#</a> 使用请求</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//某个需要用到“查询课程接口”的vue文件</span></span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">import</span> &#123;courseSearch&#125; <span class="keyword">from</span> <span class="string">&#x27;@/api/course.js&#x27;</span></span><br><span class="line"></span><br><span class="line">……</span><br><span class="line"><span class="title function_">courseSearch</span>(&#123;</span><br><span class="line">  <span class="comment">//传入需求的参数的值</span></span><br><span class="line">  <span class="attr">pageNum</span>:<span class="number">1</span>,</span><br><span class="line">  <span class="attr">pageSize</span>:<span class="number">10</span></span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">&#125;)</span><br><span class="line">……</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></div></article><div class="toc-container"><div id="toc" class="toc-article"><strong class="toc-title">目录</strong><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF-%E5%90%8E%E7%AB%AF-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%97%B4%E7%9A%84%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93"><span class="toc-text">前端 - 后端 - 数据库间的数据传输</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E8%AF%B7%E6%B1%82%E6%B5%81%E7%A8%8B"><span class="toc-text">前端请求流程</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%8D%E8%BF%9B%E8%A1%8C%E5%B0%81%E8%A3%85%E7%9B%B4%E6%8E%A5%E4%BD%BF%E7%94%A8-axios-%E4%B8%80%E8%88%AC%E6%9C%89%E4%B8%A4%E7%A7%8D%E6%96%B9%E5%BC%8F"><span class="toc-text">不进行封装直接使用 axios 一般有两种方式：</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-axiosget-axiospost"><span class="toc-text">1. axios.get() 、 axios.post()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-axios"><span class="toc-text">2. axios({})</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-%E5%AE%9E%E9%99%85%E5%BC%80%E5%8F%91%E6%83%85%E5%86%B5%E4%B8%8B%E7%9A%84%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82"><span class="toc-text">2. 实际开发情况下的网络请求</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%9E%E9%99%85%E5%BC%80%E5%8F%91%E4%B8%AD%E5%89%8D%E7%AB%AF%E8%AF%B7%E6%B1%82%E6%8E%A5%E5%8F%A3%E4%BC%9A%E5%87%BA%E7%8E%B0%E8%B7%A8%E5%9F%9F"><span class="toc-text">实际开发中，前端请求接口会出现跨域</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F%E5%89%8D%E7%AB%AF%E8%A7%A3%E5%86%B3-%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86"><span class="toc-text">解决跨域：前端解决 ——&gt; 设置代理</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%BB%E8%A6%81%E7%9A%84%E6%96%87%E4%BB%B6"><span class="toc-text">主要的文件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E8%AF%B7%E6%B1%82%E6%8E%A5%E5%8F%A3%E7%9A%84%E5%B0%81%E8%A3%85axios-%E4%BA%8C%E6%AC%A1%E5%B0%81%E8%A3%85"><span class="toc-text">前端请求接口的封装 (axios 二次封装)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#api-%E6%8E%A5%E5%8F%A3%E7%BB%9F%E4%B8%80%E7%AE%A1%E7%90%86"><span class="toc-text">api 接口统一管理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%AF%B7%E6%B1%82"><span class="toc-text">使用请求</span></a></li></ol></li></ol></div></div></div><div class="copyright"><span>本作品采用</span> <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by/4.0/">知识共享署名 4.0 国际许可协议</a> <span>进行许可。 转载时请注明原文链接。</span></div><div class="share" style="width:100%"></div><div class="post-nav"><div class="post-nav-item post-nav-next"><span>〈 </span><a href="/2023/04/12/TypeScript%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3/" rel="next" title="TypeScript中文文档">TypeScript中文文档</a></div><div class="post-nav-item post-nav-prev"><a href="/2023/04/14/VueRouter/" rel="prev" title="VueRouter">VueRouter </a><span>〉</span></div></div></div></div><footer class="footer text-center"><div id="bottom-inner"><a class="bottom-item" href="https://eucli.top">首页</a> | <a class="bottom-item" href="https://0xff000000.com" target="_blank">主站</a> | <a class="bottom-item" href="https://github.com/monokuma3121" target="_blank">GitHub</a> | <a class="bottom-item" href="https://hexo.io" target="_blank">Powered by hexo</a> | <a class="bottom-item" href="https://github.com/KevinOfNeu/hexo-theme-xoxo" target="_blank">Theme xoxo</a></div></footer><script>!function(e,t,n){function o(){cancelAnimationFrame(d),d=requestAnimationFrame(function e(){var n=t.body.scrollTop||t.documentElement.scrollTop;n>0?(t.body.scrollTop=t.documentElement.scrollTop=n-50,d=requestAnimationFrame(e)):cancelAnimationFrame(d)})}function a(){c(".heart{z-index:9999;width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);}.heart:after,.heart:before{content: '';width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: absolute;}.heart:after{top: -5px;}.heart:before{left: -5px;}"),r(),i(),m()}function i(){for(var e=0;e<u.length;e++)u[e].alpha<=0?(t.body.removeChild(u[e].el),u.splice(e,1)):(u[e].y--,u[e].scale+=.004,u[e].alpha-=.013,u[e].el.style.cssText="left:"+u[e].x+"px;top:"+u[e].y+"px;opacity:"+u[e].alpha+";transform:scale("+u[e].scale+","+u[e].scale+") rotate(45deg);background:"+u[e].color);requestAnimationFrame(i)}function r(){var n="function"==typeof e.onclick&&e.onclick,a=t.getElementById("logo");a&&(a.onclick=function(e){o(),n&&n(),l(e)})}function l(e){var n=t.createElement("div");n.className="heart",u.push({el:n,x:e.clientX-5,y:e.clientY-5,scale:1,alpha:1,color:s()}),t.body.appendChild(n)}function c(e){var n=t.createElement("style");n.type="text/css";try{n.appendChild(t.createTextNode(e))}catch(o){n.styleSheet.cssText=e}t.getElementsByTagName("head")[0].appendChild(n)}function s(){return"#F44336"}function m(){var e=t.getElementById("menu-main-post");if(e){var n=t.getElementById("toc");n?e.onclick=function(){n&&("block"==n.style.display?n.style.display="none":n.style.display="block")}:e.style.display="none"}}var d=null,u=[];e.requestAnimationFrame=function(){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(e){setTimeout(e,1e3/60)}}(),a()}(window,document)</script></body></html><!-- rebuild by hrmmi -->