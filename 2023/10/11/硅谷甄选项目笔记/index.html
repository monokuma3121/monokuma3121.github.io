<!-- build time:Tue Nov 07 2023 11:58:54 GMT+0800 (香港标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="Eucliの小窝" href="https://eucli.top/rss.xml"><link rel="alternate" type="application/atom+xml" title="Eucliの小窝" href="https://eucli.top/atom.xml"><link rel="alternate" type="application/json" title="Eucliの小窝" href="https://eucli.top/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="实战,后台管理系统"><link rel="canonical" href="https://eucli.top/2023/10/11/%E7%A1%85%E8%B0%B7%E7%94%84%E9%80%89%E9%A1%B9%E7%9B%AE%E7%AC%94%E8%AE%B0/"><title>硅谷甄选项目笔记 - 前端 | Eucliの小窝 = Eucli の小窝</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">硅谷甄选项目笔记</h1><div class="meta"><span class="item" title="创建时间：2023-10-11 21:45:48"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2023-10-11T21:45:48+08:00">2023-10-11</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>78k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>1:11</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Eucliの小窝</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1gipevarprfj20zk0m8npd.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1gipeyhsblkj20zk0m81kx.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1gipewr8iypj20zk0m8b29.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1gipeubcbajj20zk0m8h1h.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1giclimtf7dj20zk0m8qav.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1gipeuibk9fj20zk0m8ay2.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E5%89%8D%E7%AB%AF/" itemprop="item" rel="index" title="分类于 前端"><span itemprop="name">前端</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://eucli.top/2023/10/11/%E7%A1%85%E8%B0%B7%E7%94%84%E9%80%89%E9%A1%B9%E7%9B%AE%E7%AC%94%E8%AE%B0/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content=""><meta itemprop="description" content=", "></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Eucli の小窝"></span><div class="body md" itemprop="articleBody"><h3 id="tips-vue3-组件通信方式"><a class="anchor" href="#tips-vue3-组件通信方式">#</a> tips： vue3 组件通信方式</h3><p><strong>通信仓库地址:<span class="exturl" data-url="aHR0cHM6Ly9naXRlZS5jb20vamNoMTAxMS92dWUzX2NvbW11bmljYXRpb24uZ2l0">https://gitee.com/jch1011/vue3_communication.git</span></strong></p><p>不管是 vue2 还是 vue3, 组件通信方式很重要，不管是项目还是面试都是经常用到的知识点。</p><p><strong>比如:vue2 组件通信方式</strong></p><p>**props:** 可以实现父子组件、子父组件、甚至兄弟组件通信</p><p><strong>自定义事件</strong>：可以实现子父组件通信</p><p><strong>全局事件总线 $bus</strong>: 可以实现任意组件通信</p><p>**pubsub:** 发布订阅模式实现任意组件通信</p><p><strong>vuex</strong>: 集中式状态管理容器，实现任意组件通信</p><p><strong>ref</strong>: 父组件获取子组件实例 VC, 获取子组件的响应式数据以及方法</p><p>**slot:** 插槽 (默认插槽、具名插槽、作用域插槽) 实现父子组件通信........</p><h1 id="硅谷甄选运营平台"><a class="anchor" href="#硅谷甄选运营平台">#</a> 硅谷甄选运营平台</h1><p>此次教学课程为硅谷甄选运营平台项目，包含运营平台项目模板从 0 到 1 开发，以及数据大屏幕、权限等业务。</p><p>此次教学课程涉及到技术栈包含 **<em>:vue3+TypeScript+vue-router+pinia+element-plus+axios+echarts</em>** 等技术栈。</p><h2 id="一-搭建后台管理系统模板"><a class="anchor" href="#一-搭建后台管理系统模板">#</a> 一、搭建后台管理系统模板</h2><h3 id="11-项目初始化-适用于团队开发场景自己的项目不用配置的那么麻烦"><a class="anchor" href="#11-项目初始化-适用于团队开发场景自己的项目不用配置的那么麻烦">#</a> 1.1 项目初始化 (适用于团队开发场景，自己的项目不用配置的那么麻烦)</h3><p>今天来带大家从 0 开始搭建一个 vue3 版本的后台管理系统。一个项目要有统一的规范，需要使用 eslint+stylelint+prettier 来对我们的代码质量做检测和修复，需要使用 husky 来做 commit 拦截，需要使用 commitlint 来统一提交规范，需要使用 preinstall 来统一包管理工具。</p><p>下面我们就用这一套规范来初始化我们的项目，集成一个规范的模版。</p><blockquote><p><strong>环境准备</strong></p><ul><li>node v16.14.2</li><li>pnpm 8.0.0</li></ul></blockquote><p>本项目使用 vite 进行构建，vite 官方中文文档参考：<span class="exturl" data-url="aHR0cHM6Ly9jbi52aXRlanMuZGV2L2d1aWRlLw==">cn.vitejs.dev/guide/</span></p><p><strong>pnpm:performant npm ，意味 “高性能的 npm”。<span class="exturl" data-url="aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/cT1wbnBtJmFtcDtzcG09MTAwMS4yMTAxLjMwMDEuNzAyMA==">pnpm</span> 由 npm/yarn 衍生而来，解决了 npm/yarn 内部潜在的 bug，极大的优化了性能，扩展了使用场景。被誉为 “最先进的包管理工具”</strong></p><ol><li>安装 pnpm</li></ol><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">npm</span> i <span class="token parameter variable">-g</span> <span class="token function">pnpm</span></pre></td></tr></table></figure><ol start="2"><li>使用 pnpm 命令，vite 脚手架初始化项目:</li></ol><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">pnpm</span> create vite</pre></td></tr></table></figure><ol start="3"><li>启动项目</li></ol><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token builtin class-name">cd</span> 项目地址 <span class="token operator">&amp;&amp;</span> <span class="token function">pnpm</span> i <span class="token operator">&amp;&amp;</span> <span class="token function">pnpm</span> run dev</pre></td></tr></table></figure><h3 id="12-项目配置"><a class="anchor" href="#12-项目配置">#</a> 1.2 项目配置</h3><h4 id="121-eslint-配置"><a class="anchor" href="#121-eslint-配置">#</a> 1.2.1 eslint 配置</h4><p><strong>eslint 中文官网:<span class="exturl" data-url="aHR0cDovL2VzbGludC5jbi8=">http://eslint.cn/</span></strong></p><p>ESLint 最初是由<span class="exturl" data-url="aHR0cDovL25jem9ubGluZS5uZXQv"> Nicholas C. Zakas</span> 于 2013 年 6 月创建的开源项目。它的目标是提供一个插件化的<strong> javascript 代码检测工具</strong></p><ol><li>首先安装 eslint</li></ol><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">pnpm</span> i eslint <span class="token parameter variable">-D</span></pre></td></tr></table></figure><ol start="2"><li>生成配置文件:.eslint.cjs</li></ol><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>npx eslint <span class="token parameter variable">--init</span></pre></td></tr></table></figure><ol start="3"><li>在 <code>.eslint.cjs</code> 中进行配置：</li></ol><pre><code class="language-cjs">module.exports = &#123;
  //运行环境
  env: &#123;
    browser: true, //浏览器端
    es2021: true, //es2021
  &#125;,
  //规则继承
  extends: [
    //全部规则默认是关闭的,这个配置项开启推荐规则,推荐规则参照文档
    //比如:函数不能重名、对象不能出现重复key
    &quot;eslint:recommended&quot;,
    //vue3语法规则
    &quot;plugin:vue/vue3-essential&quot;,
    //ts语法规则
    &quot;plugin:@typescript-eslint/recommended&quot;,
  ],
  //要为特定类型的文件指定处理器
  overrides: [],
  //指定解析器:解析器
  //Esprima 默认解析器
  //Babel-ESLint babel解析器
  //@typescript-eslint/parser ts解析器
  parser: &quot;@typescript-eslint/parser&quot;,
  //指定解析器选项
  parserOptions: &#123;
    ecmaVersion: &quot;latest&quot;, //校验ECMA最新版本
    sourceType: &quot;module&quot;, //设置为&quot;script&quot;（默认），或者&quot;module&quot;代码在ECMAScript模块中
  &#125;,
  //ESLint支持使用第三方插件。在使用插件之前，您必须使用npm安装它
  //该eslint-plugin-前缀可以从插件名称被省略
  plugins: [&quot;vue&quot;, &quot;@typescript-eslint&quot;],
  //eslint规则
  rules: &#123;&#125;,
&#125;;
</code></pre><h5 id="1211-vue3-环境代码校验插件"><a class="anchor" href="#1211-vue3-环境代码校验插件">#</a> 1.2.1.1 vue3 环境代码校验插件</h5><pre><code># 让所有与prettier规则存在冲突的Eslint rules失效，并使用prettier进行代码检查
&quot;eslint-config-prettier&quot;: &quot;^8.6.0&quot;,
&quot;eslint-plugin-import&quot;: &quot;^2.27.5&quot;,
&quot;eslint-plugin-node&quot;: &quot;^11.1.0&quot;,
# 运行更漂亮的Eslint，使prettier规则优先级更高，Eslint优先级低
&quot;eslint-plugin-prettier&quot;: &quot;^4.2.1&quot;,
# vue.js的Eslint插件（查找vue语法错误，发现错误指令，查找违规风格指南
&quot;eslint-plugin-vue&quot;: &quot;^9.9.0&quot;,
# 该解析器允许使用Eslint校验所有babel code
&quot;@babel/eslint-parser&quot;: &quot;^7.19.1&quot;,
</code></pre><p>安装指令</p><pre><code>pnpm install -D eslint-plugin-import eslint-plugin-vue eslint-plugin-node eslint-plugin-prettier eslint-config-prettier eslint-plugin-node @babel/eslint-parser
</code></pre><h5 id="12-修改eslintrccjs-配置文件"><a class="anchor" href="#12-修改eslintrccjs-配置文件">#</a> 1.2 修改.eslintrc.cjs 配置文件</h5><pre><code>// @see https://eslint.bootcss.com/docs/rules/

module.exports = &#123;
  env: &#123;
    browser: true,
    es2021: true,
    node: true,
    jest: true,
  &#125;,
  /* 指定如何解析语法 */
  parser: 'vue-eslint-parser',
  /** 优先级低于 parse 的语法解析配置 */
  parserOptions: &#123;
    ecmaVersion: 'latest',
    sourceType: 'module',
    parser: '@typescript-eslint/parser',
    jsxPragma: 'React',
    ecmaFeatures: &#123;
      jsx: true,
    &#125;,
  &#125;,
  /* 继承已有的规则 */
  extends: [
    'eslint:recommended',
    'plugin:vue/vue3-essential',
    'plugin:@typescript-eslint/recommended',
    'plugin:prettier/recommended',
  ],
  plugins: ['vue', '@typescript-eslint'],
  /*
   * &quot;off&quot; 或 0    ==&gt;  关闭规则
   * &quot;warn&quot; 或 1   ==&gt;  打开的规则作为警告（不影响代码执行）
   * &quot;error&quot; 或 2  ==&gt;  规则作为一个错误（代码不能执行，界面报错）
   */
  rules: &#123;
    // eslint（https://eslint.bootcss.com/docs/rules/）
    'no-var': 'error', // 要求使用 let 或 const 而不是 var
    'no-multiple-empty-lines': ['warn', &#123; max: 1 &#125;], // 不允许多个空行
    'no-console': process.env.NODE_ENV === 'production' ? 'error' : 'off',
    'no-debugger': process.env.NODE_ENV === 'production' ? 'error' : 'off',
    'no-unexpected-multiline': 'error', // 禁止空余的多行
    'no-useless-escape': 'off', // 禁止不必要的转义字符

    // typeScript (https://typescript-eslint.io/rules)
    '@typescript-eslint/no-unused-vars': 'error', // 禁止定义未使用的变量
    '@typescript-eslint/prefer-ts-expect-error': 'error', // 禁止使用 @ts-ignore
    '@typescript-eslint/no-explicit-any': 'off', // 禁止使用 any 类型
    '@typescript-eslint/no-non-null-assertion': 'off',
    '@typescript-eslint/no-namespace': 'off', // 禁止使用自定义 TypeScript 模块和命名空间。
    '@typescript-eslint/semi': 'off',

    // eslint-plugin-vue (https://eslint.vuejs.org/rules/)
    'vue/multi-word-component-names': 'off', // 要求组件名称始终为 “-” 链接的单词
    'vue/script-setup-uses-vars': 'error', // 防止&lt;script setup&gt;使用的变量&lt;template&gt;被标记为未使用
    'vue/no-mutating-props': 'off', // 不允许组件 prop的改变
    'vue/attribute-hyphenation': 'off', // 对模板中的自定义组件强制执行属性命名样式
  &#125;,
&#125;

</code></pre><h5 id="13eslintignore-忽略文件"><a class="anchor" href="#13eslintignore-忽略文件">#</a> 1.3.eslintignore 忽略文件</h5><pre><code>dist
node_modules
</code></pre><h5 id="14-运行脚本"><a class="anchor" href="#14-运行脚本">#</a> 1.4 运行脚本</h5><p>package.json 新增两个运行脚本</p><pre><code>&quot;scripts&quot;: &#123;
    &quot;lint&quot;: &quot;eslint src&quot;,
    &quot;fix&quot;: &quot;eslint src --fix&quot;,
&#125;
</code></pre><h4 id="二-配置prettier-vscode-好像有-pretter-插件"><a class="anchor" href="#二-配置prettier-vscode-好像有-pretter-插件">#</a> 二、配置<strong> prettier</strong> (vscode 好像有 pretter 插件)</h4><p>有了 eslint，为什么还要有 prettier？eslint 针对的是 javascript，他是一个检测工具，包含 js 语法以及少部分格式问题，在 eslint 看来，语法对了就能保证代码正常运行，格式问题属于其次；</p><p>而 prettier 属于格式化工具，它看不惯格式不统一，所以它就把 eslint 没干好的事接着干，另外，prettier 支持</p><p>包含 js 在内的多种语言。</p><p>总结起来，<strong>eslint 和 prettier 这俩兄弟一个保证 js 代码质量，一个保证代码美观。</strong></p><h5 id="21-安装依赖包"><a class="anchor" href="#21-安装依赖包">#</a> 2.1 安装依赖包</h5><pre><code>pnpm install -D eslint-plugin-prettier prettier eslint-config-prettier
</code></pre><h5 id="22prettierrcjson-添加规则"><a class="anchor" href="#22prettierrcjson-添加规则">#</a> 2.2.prettierrc.json 添加规则</h5><pre><code>&#123;
  &quot;singleQuote&quot;: true,
  &quot;semi&quot;: false,
  &quot;bracketSpacing&quot;: true,
  &quot;htmlWhitespaceSensitivity&quot;: &quot;ignore&quot;,
  &quot;endOfLine&quot;: &quot;auto&quot;,
  &quot;trailingComma&quot;: &quot;all&quot;,
  &quot;tabWidth&quot;: 2
&#125;
</code></pre><h5 id="23prettierignore-忽略文件"><a class="anchor" href="#23prettierignore-忽略文件">#</a> 2.3.prettierignore 忽略文件</h5><pre><code>/dist/*
/html/*
.local
/node_modules/**
**/*.svg
**/*.sh
/public/*
</code></pre><p><strong>通过 pnpm run lint 去检测语法，如果出现不规范格式，通过 pnpm run fix 修改</strong></p><h4 id="三-配置-stylelint-感觉没必要"><a class="anchor" href="#三-配置-stylelint-感觉没必要">#</a> 三、配置 stylelint (感觉没必要)</h4><p><span class="exturl" data-url="aHR0cHM6Ly9zdHlsZWxpbnQuaW8v">stylelint</span> 为 css 的 lint 工具。可格式化 css 代码，检查 css 语法错误与不合理的写法，指定 css 书写顺序等。</p><p>我们的项目中使用 scss 作为预处理器，安装以下依赖：</p><pre><code>pnpm add sass sass-loader stylelint postcss postcss-scss postcss-html stylelint-config-prettier stylelint-config-recess-order stylelint-config-recommended-scss stylelint-config-standard stylelint-config-standard-vue stylelint-scss stylelint-order stylelint-config-standard-scss -D
</code></pre><h5 id="31stylelintrccjs配置文件"><a class="anchor" href="#31stylelintrccjs配置文件">#</a> 3.1 <code>.stylelintrc.cjs</code> <strong>配置文件</strong></h5><p><strong>官网:<span class="exturl" data-url="aHR0cHM6Ly9zdHlsZWxpbnQuYm9vdGNzcy5jb20v">https://stylelint.bootcss.com/</span></strong></p><pre><code>// @see https://stylelint.bootcss.com/

module.exports = &#123;
  extends: [
    'stylelint-config-standard', // 配置stylelint拓展插件
    'stylelint-config-html/vue', // 配置 vue 中 template 样式格式化
    'stylelint-config-standard-scss', // 配置stylelint scss插件
    'stylelint-config-recommended-vue/scss', // 配置 vue 中 scss 样式格式化
    'stylelint-config-recess-order', // 配置stylelint css属性书写顺序插件,
    'stylelint-config-prettier', // 配置stylelint和prettier兼容
  ],
  overrides: [
    &#123;
      files: ['**/*.(scss|css|vue|html)'],
      customSyntax: 'postcss-scss',
    &#125;,
    &#123;
      files: ['**/*.(html|vue)'],
      customSyntax: 'postcss-html',
    &#125;,
  ],
  ignoreFiles: [
    '**/*.js',
    '**/*.jsx',
    '**/*.tsx',
    '**/*.ts',
    '**/*.json',
    '**/*.md',
    '**/*.yaml',
  ],
  /**
   * null  =&gt; 关闭该规则
   * always =&gt; 必须
   */
  rules: &#123;
    'value-keyword-case': null, // 在 css 中使用 v-bind，不报错
    'no-descending-specificity': null, // 禁止在具有较高优先级的选择器后出现被其覆盖的较低优先级的选择器
    'function-url-quotes': 'always', // 要求或禁止 URL 的引号 &quot;always(必须加上引号)&quot;|&quot;never(没有引号)&quot;
    'no-empty-source': null, // 关闭禁止空源码
    'selector-class-pattern': null, // 关闭强制选择器类名的格式
    'property-no-unknown': null, // 禁止未知的属性(true 为不允许)
    'block-opening-brace-space-before': 'always', //大括号之前必须有一个空格或不能有空白符
    'value-no-vendor-prefix': null, // 关闭 属性值前缀 --webkit-box
    'property-no-vendor-prefix': null, // 关闭 属性前缀 -webkit-mask
    'selector-pseudo-class-no-unknown': [
      // 不允许未知的选择器
      true,
      &#123;
        ignorePseudoClasses: ['global', 'v-deep', 'deep'], // 忽略属性，修改element默认样式的时候能使用到
      &#125;,
    ],
  &#125;,
&#125;
</code></pre><h5 id="32stylelintignore-忽略文件"><a class="anchor" href="#32stylelintignore-忽略文件">#</a> 3.2.stylelintignore 忽略文件</h5><pre><code>/node_modules/*
/dist/*
/html/*
/public/*
</code></pre><h5 id="33-运行脚本"><a class="anchor" href="#33-运行脚本">#</a> 3.3 运行脚本</h5><pre><code>&quot;scripts&quot;: &#123;
	&quot;lint:style&quot;: &quot;stylelint src/**/*.&#123;css,scss,vue&#125; --cache --fix&quot;
&#125;
</code></pre><p>最后配置统一的 prettier 来格式化我们的 js 和 css，html 代码</p><pre><code> &quot;scripts&quot;: &#123;
    &quot;dev&quot;: &quot;vite --open&quot;,
    &quot;build&quot;: &quot;vue-tsc &amp;&amp; vite build&quot;,
    &quot;preview&quot;: &quot;vite preview&quot;,
    &quot;lint&quot;: &quot;eslint src&quot;,
    &quot;fix&quot;: &quot;eslint src --fix&quot;,
    &quot;format&quot;: &quot;prettier --write \&quot;./**/*.&#123;html,vue,ts,js,json,md&#125;\&quot;&quot;,
    &quot;lint:eslint&quot;: &quot;eslint src/**/*.&#123;ts,vue&#125; --cache --fix&quot;,
    &quot;lint:style&quot;: &quot;stylelint src/**/*.&#123;css,scss,vue&#125; --cache --fix&quot;
  &#125;,
</code></pre><p><strong>当我们运行 <code>pnpm run format</code> 的时候，会把代码直接格式化</strong></p><h4 id="四-配置-husky"><a class="anchor" href="#四-配置-husky">#</a> 四、配置 husky</h4><blockquote><p>这个插件需要 git。要先 <code>git init</code> 初始化后才能用</p></blockquote><p>在上面我们已经集成好了我们代码校验工具，但是需要每次手动的去执行命令才会格式化我们的代码。如果有人没有格式化就提交了远程仓库中，那这个规范就没什么用。所以我们需要强制让开发人员按照代码规范来提交。</p><p>要做到这件事情，就需要利用 husky 在代码提交之前触发 git hook (git 在客户端的钩子)，然后执行 <code>pnpm run format</code> 来自动的格式化我们的代码。</p><p>安装 <code>husky</code></p><pre><code>pnpm install -D husky
</code></pre><p>执行</p><pre><code>npx husky-init
</code></pre><p>会在根目录下生成个一个.husky 目录，在这个目录下面会有一个 pre-commit 文件，这个文件里面的命令在我们执行 commit 的时候就会执行</p><p>在 <code>.husky/pre-commit</code> 文件添加如下命令：</p><pre><code>#!/usr/bin/env sh
. &quot;$(dirname -- &quot;$0&quot;)/_/husky.sh&quot;
pnpm run format
</code></pre><p>当我们对代码进行 commit 操作的时候，就会执行命令，对代码进行格式化，然后再提交。</p><h4 id="五-配置-commitlint"><a class="anchor" href="#五-配置-commitlint">#</a> 五、配置 commitlint</h4><p>对于我们的 commit 信息，也是有统一规范的，不能随便写，要让每个人都按照统一的标准来执行，我们可以利用<strong> commitlint</strong> 来实现。</p><p>安装包</p><pre><code>pnpm add @commitlint/config-conventional @commitlint/cli -D
</code></pre><p>添加配置文件，新建 <code>commitlint.config.cjs</code> (注意是 cjs)，然后添加下面的代码：</p><pre><code>module.exports = &#123;
  extends: ['@commitlint/config-conventional'],
  // 校验规则
  rules: &#123;
    'type-enum': [
      2,
      'always',
      [
        'feat',
        'fix',
        'docs',
        'style',
        'refactor',
        'perf',
        'test',
        'chore',
        'revert',
        'build',
      ],
    ],
    'type-case': [0],
    'type-empty': [0],
    'scope-empty': [0],
    'scope-case': [0],
    'subject-full-stop': [0, 'never'],
    'subject-case': [0, 'never'],
    'header-max-length': [0, 'always', 72],
  &#125;,
&#125;
</code></pre><p>在 <code>package.json</code> 中配置 scripts 命令</p><pre><code># 在scrips中添加下面的代码
&#123;
&quot;scripts&quot;: &#123;
    &quot;commitlint&quot;: &quot;commitlint --config commitlint.config.cjs -e -V&quot;
  &#125;,
&#125;
</code></pre><p>配置结束，现在当我们填写 <code>commit</code> 信息的时候，前面就需要带着下面的 <code>subject</code></p><pre><code>'feat',//新特性、新功能
'fix',//修改bug
'docs',//文档修改
'style',//代码格式修改, 注意不是 css 修改
'refactor',//代码重构
'perf',//优化相关，比如提升性能、体验
'test',//测试用例修改
'chore',//其他修改, 比如改变构建流程、或者增加依赖库、工具等
'revert',//回滚到上一个版本
'build',//编译相关的修改，例如发布版本、对项目构建或者依赖的改动
</code></pre><p>配置 husky</p><pre><code>npx husky add .husky/commit-msg
</code></pre><p>在生成的 commit-msg 文件中添加下面的命令</p><pre><code>#!/usr/bin/env sh
. &quot;$(dirname -- &quot;$0&quot;)/_/husky.sh&quot;
pnpm commitlint
</code></pre><p>当我们 commit 提交信息时，就不能再随意写了，必须是 git commit -m 'fix: xxx' 符合类型的才可以，<strong>需要注意的是类型的后面需要用英文的 :，并且冒号后面是需要空一格的，这个是不能省略的</strong></p><h4 id="六-强制使用-pnpm-包管理器工具"><a class="anchor" href="#六-强制使用-pnpm-包管理器工具">#</a> 六、强制使用 pnpm 包管理器工具</h4><p>团队开发项目的时候，需要统一包管理器工具，因为不同包管理器工具下载同一个依赖，可能版本不一样，</p><p>导致项目出现 bug 问题，因此包管理器工具需要统一管理！！！</p><p>在根目录创建 <code>scripts/preinstall.js</code> 文件，添加下面的内容</p><pre><code>if (!/pnpm/.test(process.env.npm_execpath || '')) &#123;
  console.warn(
    `\u001b[33mThis repository must using pnpm as the package manager ` +
    ` for scripts to work properly.\u001b[39m\n`,
  )
  process.exit(1)
&#125;
</code></pre><p>配置命令</p><pre><code>&quot;scripts&quot;: &#123;
	&quot;preinstall&quot;: &quot;node ./scripts/preinstall.js&quot;
&#125;
</code></pre><p><strong>当我们使用 npm 或者 yarn 来安装包的时候，就会报错了。原理就是在 install 的时候会触发 preinstall（npm 提供的生命周期钩子）这个文件里面的代码。</strong></p><h2 id="二-项目集成"><a class="anchor" href="#二-项目集成">#</a> 二、项目集成</h2><h3 id="21-集成-element-plus"><a class="anchor" href="#21-集成-element-plus">#</a> 2.1 集成 element-plus</h3><p>硅谷甄选运营平台，UI 组件库采用的 element-plus，因此需要集成 element-plus 插件！！！</p><p>官网地址:<span class="exturl" data-url="aHR0cHM6Ly9lbGVtZW50LXBsdXMuZ2l0ZWUuaW8vemgtQ04v">https://element-plus.gitee.io/zh-CN/</span></p><pre><code>pnpm install element-plus @element-plus/icons-vue
</code></pre><p><strong>入口文件 main.ts 全局安装 element-plus,element-plus 默认支持语言英语设置为中文</strong></p><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> ElementPlus <span class="token keyword">from</span> <span class="token string">"element-plus"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> <span class="token string">"element-plus/dist/index.css"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">//@ts-ignore 忽略当前文件 ts 类型的检测否则有红色提示 (打包会失败)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">import</span> zhCn <span class="token keyword">from</span> <span class="token string">"element-plus/dist/locale/zh-cn.mjs"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>ElementPlus<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  locale<span class="token operator">:</span> zhCn<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>Element Plus 全局组件类型声明</strong></p><figure class="highlight json"><figcaption data-lang="JSON"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// tsconfig.json</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token comment">// ...</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token property">"types"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"element-plus/global"</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>配置完毕可以测试 element-plus 组件与图标的使用.</p><h3 id="22-src-别名的配置"><a class="anchor" href="#22-src-别名的配置">#</a> 2.2 src 别名的配置</h3><p>在开发项目的时候文件与文件关系可能很复杂，因此我们需要给 src 文件夹配置一个别名！！！</p><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// vite.config.ts</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> defineConfig <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"vite"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> vue <span class="token keyword">from</span> <span class="token string">"@vitejs/plugin-vue"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">import</span> path <span class="token keyword">from</span> <span class="token string">"path"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  resolve<span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    alias<span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>      <span class="token string-property property">"@"</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">"./src"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 相对路径别名配置，使用 @ 代替 src</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>TypeScript 编译配置</strong></p><figure class="highlight json"><figcaption data-lang="JSON"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// tsconfig.json</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token property">"baseUrl"</span><span class="token operator">:</span> <span class="token string">"./"</span><span class="token punctuation">,</span> <span class="token comment">// 解析非相对模块的基地址，默认是当前目录</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token property">"paths"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>      <span class="token comment">// 路径映射，相对于 baseUrl</span></pre></td></tr><tr><td data-num="7"></td><td><pre>      <span class="token property">"@/*"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"src/*"</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="23-环境变量的配置"><a class="anchor" href="#23-环境变量的配置">#</a> 2.3 环境变量的配置</h3><p><strong>项目开发过程中，至少会经历开发环境、测试环境和生产环境 (即正式环境) 三个阶段。不同阶段请求的状态 (如接口地址等) 不尽相同，若手动切换接口地址是相当繁琐且易出错的。于是环境变量配置的需求就应运而生，我们只需做简单的配置，把环境状态切换的工作交给代码。</strong></p><p>开发环境（development）<br>顾名思义，开发使用的环境，每位开发人员在自己的 dev 分支上干活，开发到一定程度，同事会合并代码，进行联调。</p><p>测试环境（testing）<br>测试同事干活的环境啦，一般会由测试同事自己来部署，然后在此环境进行测试</p><p>生产环境（production）<br>生产环境是指正式提供对外服务的，一般会关掉错误报告，打开错误日志。(正式提供给客户使用的环境。)</p><p>注意：一般情况下，一个环境对应一台服务器，也有的公司开发与测试环境是一台服务器！！！</p><p>项目根目录分别添加 开发、生产和测试环境的文件！</p><pre><code>.env.development
.env.production
.env.test
</code></pre><p>文件内容</p><pre><code># 变量必须以 VITE_ 为前缀才能暴露给外部读取
NODE_ENV = 'development'
VITE_APP_TITLE = '硅谷甄选运营平台'
VITE_APP_BASE_API = '/dev-api'
</code></pre><pre><code>NODE_ENV = 'production'
VITE_APP_TITLE = '硅谷甄选运营平台'
VITE_APP_BASE_API = '/prod-api'
</code></pre><pre><code># 变量必须以 VITE_ 为前缀才能暴露给外部读取
NODE_ENV = 'test'
VITE_APP_TITLE = '硅谷甄选运营平台'
VITE_APP_BASE_API = '/test-api'
</code></pre><p>配置运行命令：package.json</p><figure class="highlight json"><figcaption data-lang="JSON"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token property">"dev"</span><span class="token operator">:</span> <span class="token string">"vite --open"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token property">"build:test"</span><span class="token operator">:</span> <span class="token string">"vue-tsc &amp;&amp; vite build --mode test"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token property">"build:pro"</span><span class="token operator">:</span> <span class="token string">"vue-tsc &amp;&amp; vite build --mode production"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token property">"preview"</span><span class="token operator">:</span> <span class="token string">"vite preview"</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr></table></figure><p>通过 import.meta.env 获取环境变量</p><h3 id="24-svg-图标配置"><a class="anchor" href="#24-svg-图标配置">#</a> 2.4 SVG 图标配置</h3><p>在开发项目的时候经常会用到 svg 矢量图，而且我们使用 SVG 以后，页面上加载的不再是图片资源，</p><p>这对页面性能来说是个很大的提升，而且我们 SVG 文件比 img 要小的很多，放在项目中几乎不占用资源。</p><p><strong>安装 SVG 依赖插件</strong></p><pre><code>pnpm install vite-plugin-svg-icons -D
</code></pre><p><strong>在 <code>vite.config.ts</code> 中配置插件</strong></p><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> createSvgIconsPlugin <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"vite-plugin-svg-icons"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> path <span class="token keyword">from</span> <span class="token string">"path"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    plugins<span class="token operator">:</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="6"></td><td><pre>      <span class="token function">createSvgIconsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token comment">// Specify the icon folder to be cached</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        iconDirs<span class="token operator">:</span> <span class="token punctuation">[</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"src/assets/icons"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token comment">// Specify symbolId format</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        symbolId<span class="token operator">:</span> <span class="token string">"icon-[dir]-[name]"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="11"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>入口文件导入</strong></p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token string">"virtual:svg-icons-register"</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h4 id="241-svg-封装为全局组件"><a class="anchor" href="#241-svg-封装为全局组件">#</a> 2.4.1 svg 封装为全局组件</h4><p>因为项目很多模块需要使用图标，因此把它封装为全局组件！！！(这样就不用 import 引入了)</p><p><strong>在 src/components 目录下创建一个 SvgIcon 组件：代表如下</strong></p><pre><code class="language-vue">&lt;template&gt;
  &lt;div&gt;
    &lt;svg :style=&quot;&#123; width: width, height: height &#125;&quot;&gt;
      &lt;use :xlink:href=&quot;prefix + name&quot; :fill=&quot;color&quot;&gt;&lt;/use&gt;
    &lt;/svg&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
defineProps(&#123;
  //xlink:href属性值的前缀
  prefix: &#123;
    type: String,
    default: &quot;#icon-&quot;,
  &#125;,
  //svg矢量图的名字
  name: String,
  //svg图标的颜色
  color: &#123;
    type: String,
    default: &quot;&quot;,
  &#125;,
  //svg宽度
  width: &#123;
    type: String,
    default: &quot;16px&quot;,
  &#125;,
  //svg高度
  height: &#123;
    type: String,
    default: &quot;16px&quot;,
  &#125;,
&#125;);
&lt;/script&gt;
&lt;style scoped&gt;&lt;/style&gt;
</code></pre><p>在 components 文件夹目录下创建一个 <code>index.ts</code> 文件：用于注册 components 文件夹内部全部全局组件！！！</p><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> SvgIcon <span class="token keyword">from</span> <span class="token string">"@/components/SvgIcon/index.vue"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">&#123;</span> App<span class="token punctuation">,</span> Component <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"vue"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">const</span> components<span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">[</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> Component <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> SvgIcon <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token function">install</span><span class="token punctuation">(</span>app<span class="token operator">:</span> App<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>components<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>      app<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> components<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>在入口文件 <code>main.ts</code> 中引入 <code>components/index.ts</code> 文件，通过 app.use 方法安装自定义插件</p><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> gloablComponent <span class="token keyword">from</span> <span class="token string">"@/components"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>gloablComponent<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><blockquote><p>以上是注册多个全局组件的场景，如果只有一两个组件需要注册全局组件，那么不用创建 <code>src/index.ts</code> 文件，直接在入口文件 <code>main.ts</code> 配置如下代码：</p></blockquote><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> SvgIcon <span class="token keyword">from</span> <span class="token string">"@/components/SvgIcon/index.vue"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>app<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">"SvgIcon"</span><span class="token punctuation">,</span> SvgIcon<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="25-集成-sass"><a class="anchor" href="#25-集成-sass">#</a> 2.5 集成 sass</h3><p>我们目前在组件内部已经可以使用 scss 样式，因为在配置 styleLint 工具的时候，项目当中已经安装过 sass sass-loader, 因此我们再组件内可以使用 scss 语法！！！需要加上 lang=&quot;scss&quot;</p><figure class="highlight css"><figcaption data-lang="CSS"></figcaption><table><tr><td data-num="1"></td><td><pre>&lt;style scoped lang=<span class="token string">"scss"</span>>&lt;/style></pre></td></tr></table></figure><p>接下来我们为项目添加一些全局的样式</p><p>在 <code>src/styles</code> 目录下创建一个 <code>index.scss</code> 文件，当然项目中需要用到清除默认样式，因此在 index.scss 引入 <code>reset.scss</code></p><figure class="highlight scss"><figcaption data-lang="Sass (Scss)"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">@import</span> <span class="token string">"./reset.scss"</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>在入口文件 <code>main.ts</code> 引入</p><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token string">"@/styles/index.scss"</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>但是你会发现在 src/styles/index.scss 全局样式文件中没有办法使用<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>变量</mtext><mi mathvariant="normal">.</mi><mtext>因此需要给项目中引入全局变量</mtext></mrow><annotation encoding="application/x-tex">变量.因此需要给项目中引入全局变量</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord cjk_fallback">变</span><span class="mord cjk_fallback">量</span><span class="mord">.</span><span class="mord cjk_fallback">因</span><span class="mord cjk_fallback">此</span><span class="mord cjk_fallback">需</span><span class="mord cjk_fallback">要</span><span class="mord cjk_fallback">给</span><span class="mord cjk_fallback">项</span><span class="mord cjk_fallback">目</span><span class="mord cjk_fallback">中</span><span class="mord cjk_fallback">引</span><span class="mord cjk_fallback">入</span><span class="mord cjk_fallback">全</span><span class="mord cjk_fallback">局</span><span class="mord cjk_fallback">变</span><span class="mord cjk_fallback">量</span></span></span></span>.</p><p>在 styles 文件夹下创建一个 variable.scss 文件！</p><p>在 vite.config.ts 文件配置如下:</p><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>	css<span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>      preprocessorOptions<span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>        scss<span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>          javascriptEnabled<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>          additionalData<span class="token operator">:</span> <span class="token string">'@import "./src/styles/variable.scss";'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">)</span></pre></td></tr></table></figure><p><strong><code>@import &quot;./src/styles/variable.less&quot;;</code> 后面的 <code>;</code> 不要忘记，不然会报错</strong>！</p><p>配置完毕你会发现 scss 提供这些全局变量可以在组件样式中使用了！！！</p><h3 id="26-mock-数据"><a class="anchor" href="#26-mock-数据">#</a> 2.6 mock 数据</h3><p>安装依赖:<span class="exturl" data-url="aHR0cHM6Ly93d3cubnBtanMuY29tL3BhY2thZ2Uvdml0ZS1wbHVnaW4tbW9jaw==">https://www.npmjs.com/package/vite-plugin-mock</span></p><pre><code>pnpm install -D vite-plugin-mock@2.9.8 mockjs
</code></pre><blockquote><p>注意：这里要用 2.9.6 版本<br>在 <code>vite.config.js</code> 配置文件启用插件。</p></blockquote><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> UserConfigExport<span class="token punctuation">,</span> ConfigEnv <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"vite"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> viteMockServe <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"vite-plugin-mock"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> vue <span class="token keyword">from</span> <span class="token string">"@vitejs/plugin-vue"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token punctuation">&#123;</span> command <span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    plugins<span class="token operator">:</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="7"></td><td><pre>      <span class="token function">vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>      <span class="token function">viteMockServe</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token comment">//localEnabled: command === 'serve',</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        enable<span class="token operator">:</span> command <span class="token operator">===</span> <span class="token string">"serve"</span><span class="token punctuation">,</span> <span class="token comment">// 保证开发阶段可以使用 mock 接口</span></pre></td></tr><tr><td data-num="11"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>在根目录创建 mock 文件夹：去创建我们需要 mock 数据与接口！！！</p><p>在 mock 文件夹内部创建一个 user.ts 文件</p><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 用户信息数据</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">function</span> <span class="token function">createUserList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>      userId<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>      avatar<span class="token operator">:</span> <span class="token string">"https://wpimg.wallstcn.com/f778738c-e4f8-4870-b634-56703b4acafe.gif"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>      username<span class="token operator">:</span> <span class="token string">"admin"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>      password<span class="token operator">:</span> <span class="token string">"111111"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>      desc<span class="token operator">:</span> <span class="token string">"平台管理员"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>      roles<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"平台管理员"</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="11"></td><td><pre>      buttons<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"cuser.detail"</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="12"></td><td><pre>      routes<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"home"</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="13"></td><td><pre>      token<span class="token operator">:</span> <span class="token string">"Admin Token"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>      userId<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="17"></td><td><pre>      avatar<span class="token operator">:</span> <span class="token string">"https://wpimg.wallstcn.com/f778738c-e4f8-4870-b634-56703b4acafe.gif"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="18"></td><td><pre>      username<span class="token operator">:</span> <span class="token string">"system"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="19"></td><td><pre>      password<span class="token operator">:</span> <span class="token string">"111111"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="20"></td><td><pre>      desc<span class="token operator">:</span> <span class="token string">"系统管理员"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="21"></td><td><pre>      roles<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"系统管理员"</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="22"></td><td><pre>      buttons<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"cuser.detail"</span><span class="token punctuation">,</span> <span class="token string">"cuser.user"</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="23"></td><td><pre>      routes<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"home"</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="24"></td><td><pre>      token<span class="token operator">:</span> <span class="token string">"System Token"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="26"></td><td><pre>  <span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="30"></td><td><pre>  <span class="token comment">// 用户登录接口</span></pre></td></tr><tr><td data-num="31"></td><td><pre>  <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    url<span class="token operator">:</span> <span class="token string">"/api/user/login"</span><span class="token punctuation">,</span> <span class="token comment">// 请求地址</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    method<span class="token operator">:</span> <span class="token string">"post"</span><span class="token punctuation">,</span> <span class="token comment">// 请求方式</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token function-variable function">response</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">&#123;</span> body <span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>      <span class="token comment">// 获取请求体携带过来的用户名与密码</span></pre></td></tr><tr><td data-num="36"></td><td><pre>      <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> username<span class="token punctuation">,</span> password <span class="token punctuation">&#125;</span> <span class="token operator">=</span> body<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>      <span class="token comment">// 调用获取用户信息函数，用于判断是否有此用户</span></pre></td></tr><tr><td data-num="38"></td><td><pre>      <span class="token keyword">const</span> checkUser <span class="token operator">=</span> <span class="token function">createUserList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=></span> item<span class="token punctuation">.</span>username <span class="token operator">===</span> username <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">.</span>password <span class="token operator">===</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>      <span class="token comment">// 没有用户返回失败信息</span></pre></td></tr><tr><td data-num="40"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>checkUser<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>        <span class="token keyword">return</span> <span class="token punctuation">&#123;</span> code<span class="token operator">:</span> <span class="token number">201</span><span class="token punctuation">,</span> data<span class="token operator">:</span> <span class="token punctuation">&#123;</span> message<span class="token operator">:</span> <span class="token string">"账号或者密码不正确"</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>      <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>      <span class="token comment">// 如果有返回成功信息</span></pre></td></tr><tr><td data-num="44"></td><td><pre>      <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> token <span class="token punctuation">&#125;</span> <span class="token operator">=</span> checkUser<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>      <span class="token keyword">return</span> <span class="token punctuation">&#123;</span> code<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span> data<span class="token operator">:</span> <span class="token punctuation">&#123;</span> token <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="47"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="48"></td><td><pre>  <span class="token comment">// 获取用户信息</span></pre></td></tr><tr><td data-num="49"></td><td><pre>  <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>    url<span class="token operator">:</span> <span class="token string">"/api/user/info"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="51"></td><td><pre>    method<span class="token operator">:</span> <span class="token string">"get"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="52"></td><td><pre>    <span class="token function-variable function">response</span><span class="token operator">:</span> <span class="token punctuation">(</span>request<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>      <span class="token comment">// 获取请求头携带 token</span></pre></td></tr><tr><td data-num="54"></td><td><pre>      <span class="token keyword">const</span> token <span class="token operator">=</span> request<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>token<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>      <span class="token comment">// 查看用户信息是否包含有次 token 用户</span></pre></td></tr><tr><td data-num="56"></td><td><pre>      <span class="token keyword">const</span> checkUser <span class="token operator">=</span> <span class="token function">createUserList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=></span> item<span class="token punctuation">.</span>token <span class="token operator">===</span> token<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="57"></td><td><pre>      <span class="token comment">// 没有返回失败的信息</span></pre></td></tr><tr><td data-num="58"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>checkUser<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="59"></td><td><pre>        <span class="token keyword">return</span> <span class="token punctuation">&#123;</span> code<span class="token operator">:</span> <span class="token number">201</span><span class="token punctuation">,</span> data<span class="token operator">:</span> <span class="token punctuation">&#123;</span> message<span class="token operator">:</span> <span class="token string">"获取用户信息失败"</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="60"></td><td><pre>      <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="61"></td><td><pre>      <span class="token comment">// 如果有返回成功信息</span></pre></td></tr><tr><td data-num="62"></td><td><pre>      <span class="token keyword">return</span> <span class="token punctuation">&#123;</span> code<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span> data<span class="token operator">:</span> <span class="token punctuation">&#123;</span> checkUser <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="63"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="64"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="65"></td><td><pre><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><strong>安装 axios</strong></p><pre><code>pnpm install axios
</code></pre><p>最后通过 axios 测试接口！！！</p><h3 id="27-axios-二次封装"><a class="anchor" href="#27-axios-二次封装">#</a> 2.7 axios 二次封装</h3><p>在开发项目的时候避免不了与后端进行交互，因此我们需要使用 axios 插件实现发送网络请求。在开发项目的时候</p><p>我们经常会把 axios 进行二次封装。</p><p>目的:</p><p>1: 使用请求拦截器，可以在请求拦截器中处理一些业务 (开始进度条、请求头携带公共参数)</p><p>2: 使用响应拦截器，可以在响应拦截器中处理一些业务 (进度条结束、简化服务器返回的数据、处理 http 网络错误)</p><p>在 src 目录下下创建 <code>utils/request.ts</code></p><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">"axios"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> ElMessage <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"element-plus"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// 创建 axios 实例</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">let</span> request <span class="token operator">=</span> axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  baseURL<span class="token operator">:</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VITE_APP_BASE_API</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  timeout<span class="token operator">:</span> <span class="token number">5000</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">// 请求拦截器</span></pre></td></tr><tr><td data-num="9"></td><td><pre>request<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token keyword">return</span> config<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">// 响应拦截器</span></pre></td></tr><tr><td data-num="13"></td><td><pre>request<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">return</span> response<span class="token punctuation">.</span>data<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="17"></td><td><pre>  <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token comment">// 处理网络错误</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">let</span> msg <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">let</span> status <span class="token operator">=</span> error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>status<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">switch</span> <span class="token punctuation">(</span>status<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>      <span class="token keyword">case</span> <span class="token number">401</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        msg <span class="token operator">=</span> <span class="token string">"token过期"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>      <span class="token keyword">case</span> <span class="token number">403</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        msg <span class="token operator">=</span> <span class="token string">"无权访问"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>      <span class="token keyword">case</span> <span class="token number">404</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="29"></td><td><pre>        msg <span class="token operator">=</span> <span class="token string">"请求地址错误"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>      <span class="token keyword">case</span> <span class="token number">500</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="32"></td><td><pre>        msg <span class="token operator">=</span> <span class="token string">"服务器出现问题"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>        <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>      <span class="token keyword">default</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        msg <span class="token operator">=</span> <span class="token string">"无网络"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token function">ElMessage</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>      type<span class="token operator">:</span> <span class="token string">"error"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="39"></td><td><pre>      message<span class="token operator">:</span> msg<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="40"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>    <span class="token keyword">return</span> <span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="43"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> request<span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="28-api-接口统一管理"><a class="anchor" href="#28-api-接口统一管理">#</a> 2.8 API 接口统一管理</h3><p>在开发项目的时候，接口可能很多需要统一管理。在 src 目录下去创建 <code>api文件夹</code> 去统一管理项目的接口；</p><p>比如：下面方式</p><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 统一管理咱们项目用户相关的接口</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> request <span class="token keyword">from</span> <span class="token string">"@/utils/request"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">&#123;</span> loginFormData<span class="token punctuation">,</span> loginResponseData<span class="token punctuation">,</span> userInfoReponseData <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"./type"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">// 项目用户相关的请求地址</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">enum</span> <span class="token constant">API</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token constant">LOGIN_URL</span> <span class="token operator">=</span> <span class="token string">"/admin/acl/index/login"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token constant">USERINFO_URL</span> <span class="token operator">=</span> <span class="token string">"/admin/acl/index/info"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token constant">LOGOUT_URL</span> <span class="token operator">=</span> <span class="token string">"/admin/acl/index/logout"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment">// 登录接口</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">reqLogin</span> <span class="token operator">=</span> <span class="token punctuation">(</span>data<span class="token operator">:</span> loginFormData<span class="token punctuation">)</span> <span class="token operator">=></span> request<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">post</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> loginResponseData<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token constant">API</span><span class="token punctuation">.</span><span class="token constant">LOGIN_URL</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment">// 获取用户信息</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">reqUserInfo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> request<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">get</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> userInfoReponseData<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token constant">API</span><span class="token punctuation">.</span><span class="token constant">USERINFO_URL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token comment">// 退出登录</span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">reqLogout</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> request<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">post</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token constant">API</span><span class="token punctuation">.</span><span class="token constant">LOGOUT_URL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><blockquote><p>如果接口太多可以根据接口的功能分模块在 api 文件夹下新建子文件夹，如：user、product、acl。<br>接口的 ts 类型可以像本项目一样在 api 文件夹下的每个接口文件夹中分别定义 ts 类型，也可以在 src 目录下新建一个 modules 文件夹专门放接口的 ts 类型：参考 招生提报系统</p></blockquote><h3 id="29-模板的路由配置"><a class="anchor" href="#29-模板的路由配置">#</a> 2.9 模板的路由配置</h3><p>首先分析一下项目都需要有哪些路由：<br>一级路由（4 个）：登录 login、登录成功后的首页面板展示 home、404 路由、重定向路由</p><ol><li>pnpm 安装 vue-router：</li></ol><pre><code>pnpm i vue-router
</code></pre><ol start="2"><li>在 src 文件夹下创建 <code>views</code> 或 <code>pages</code> 文件夹，存放路由。<blockquote><p>注意：views 文件夹中存放路由页面（组件），router 文件夹中放路由表</p></blockquote></li></ol><p>根据需求，分别创建一级路由：home，login，404</p><ol start="3"><li>在 src 目录下创建 <code>router</code> 文件夹，存放路由表，配置路由。<br>搭建出路由基本模板：</li></ol><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 通过 vue-router 插件实现模板路由的配置</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> createRouter<span class="token punctuation">,</span> createWebHashHistory <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"vue-router"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">// 创建路由器</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token comment">// 路由模式 hash</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  history<span class="token operator">:</span> <span class="token function">createWebHashHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  routes<span class="token operator">:</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>      path<span class="token operator">:</span> <span class="token string">"/login"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="11"></td><td><pre>      name<span class="token operator">:</span> <span class="token string">"/login"</span><span class="token punctuation">,</span> <span class="token comment">// 命名路由。加名字方便后面控制菜单权限，根据用户信息匹配路由</span></pre></td></tr><tr><td data-num="12"></td><td><pre>      <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">"@/views/login/index.vue"</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token comment">// 省略其他路由……</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  <span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> router<span class="token punctuation">;</span></pre></td></tr></table></figure><p>当然，通常我们实际写项目的时候都会把 routes 单独摘出来：</p><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 通过 vue-router 插件实现模板路由的配置</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> createRouter<span class="token punctuation">,</span> createWebHashHistory <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"vue-router"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    path<span class="token operator">:</span> <span class="token string">"/login"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    name<span class="token operator">:</span> <span class="token string">"/login"</span><span class="token punctuation">,</span> <span class="token comment">// 命名路由。加名字方便后面控制菜单权限，根据用户信息匹配路由</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">"@/views/login/index.vue"</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    path<span class="token operator">:</span> <span class="token string">"/"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    name<span class="token operator">:</span> <span class="token string">"/home"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">"@/views/home/index.vue"</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    path<span class="token operator">:</span> <span class="token string">"/404"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    name<span class="token operator">:</span> <span class="token string">"/404"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">"@/views/404/index.vue"</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="19"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="20"></td><td><pre>  <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token comment">// 重定向</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    path<span class="token operator">:</span> <span class="token string">"/:pathMatch(.*)*"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    name<span class="token operator">:</span> <span class="token string">"any"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    redirect<span class="token operator">:</span> <span class="token string">"/404"</span><span class="token punctuation">,</span> <span class="token comment">// 也可重定向到首页 home</span></pre></td></tr><tr><td data-num="25"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token comment">// 创建路由器</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>  <span class="token comment">// 路由模式 hash</span></pre></td></tr><tr><td data-num="31"></td><td><pre>  history<span class="token operator">:</span> <span class="token function">createWebHashHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="32"></td><td><pre>  routes<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> router<span class="token punctuation">;</span></pre></td></tr></table></figure><ol start="4"><li>在入口文件 main.ts 中注册一下路由：</li></ol><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">"./router"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><ol start="5"><li>之后便可以在 <code>App.vue</code> 中使用：</li></ol><pre><code class="language-vue">&lt;router-view&gt;&lt;/router-view&gt;
</code></pre><h3 id="210-pinia-仓库"><a class="anchor" href="#210-pinia-仓库">#</a> 2.10 pinia 仓库</h3><ol><li>pnpm i pinia</li><li>src/store/index.ts</li><li>创建大仓库：</li></ol><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> createPinia <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"pinia"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 创建大仓库</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">let</span> pinia <span class="token operator">=</span> <span class="token function">createPinia</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">// 对外暴露：入口文件需要安装仓库</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> pinia<span class="token punctuation">;</span></pre></td></tr></table></figure><ol start="4"><li>入口文件 main.ts 引入</li></ol><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 引入仓库</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> pinia <span class="token keyword">from</span> <span class="token string">"./store"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// 安装仓库</span></pre></td></tr><tr><td data-num="4"></td><td><pre>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>pinia<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><ol start="5"><li>创建用户相关的小仓库：src/modules/user.ts</li></ol><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> defineStore <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"pinia"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 创建小仓库</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">let</span> useUserStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">"User"</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token comment">// 小仓库存储数据的地方</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token function-variable function">state</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token comment">// 处理异步 | 逻辑的地方</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  actions<span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  getters<span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> useUserStore<span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="211-login-路由页面"><a class="anchor" href="#211-login-路由页面">#</a> 2.11 login 路由页面</h3><ol><li>写 html、css 样式，把骨架搭建起来，收集输入框的账号、密码表单数据</li><li>登录按钮，点击后仓库发送登录请求</li></ol><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">//login.vue 的 script 部分</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> useUserStore <span class="token keyword">from</span> <span class="token string">"@/store/modules/user"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">let</span> useStore <span class="token operator">=</span> <span class="token function">useUserStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">login</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token comment">// 点击登录后干什么？</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token comment">// 通知仓库发登录请求</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token comment">// 请求成功 - 首页 home</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token comment">// 请求失败 - 弹出登录失败信息</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  useStore<span class="token punctuation">.</span><span class="token function">userLogin</span><span class="token punctuation">(</span>loginForm<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 把表单收集到的账号密码传递过去</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure><ol start="3"><li>在小仓库 user.ts 中写 <code>userLogin()</code> 方法</li></ol><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> defineStore <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"pinia"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 引入接口</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> reqLogin <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"@/api/user"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">// 引入数据类型</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">&#123;</span> loginForm <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"@/api/user/type"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">// 创建小仓库</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">let</span> useUserStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">"User"</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token comment">// 小仓库存储数据的地方</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token function-variable function">state</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>      token<span class="token operator">:</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">"TOKEN"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 用户唯一标识 token</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token comment">// 处理异步 | 逻辑的地方</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  actions<span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token comment">// 用户登录的方法</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">async</span> <span class="token function">userLogin</span><span class="token punctuation">(</span>data<span class="token operator">:</span> loginForm<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>      <span class="token comment">// 登录请求</span></pre></td></tr><tr><td data-num="19"></td><td><pre>      <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">reqLogin</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>      <span class="token comment">// 登录请求成功 200->token</span></pre></td></tr><tr><td data-num="21"></td><td><pre>      <span class="token comment">// 登录请求失败 201-> 登录失败错误信息</span></pre></td></tr><tr><td data-num="22"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token comment">//pinia 仓库存储一下 token</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token comment">// 由于 pinia|vuex 存储数据其实是利用 js 对象</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token keyword">this</span><span class="token punctuation">.</span>token <span class="token operator">==</span> result<span class="token punctuation">.</span>data<span class="token punctuation">.</span>token<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token comment">// 本地存储持久化存储一份</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">"TOKEN"</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>data<span class="token punctuation">.</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>        <span class="token comment">// 也可以用 pinia-plugin-persistedstate 插件持久化存储</span></pre></td></tr><tr><td data-num="29"></td><td><pre>      <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="31"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="32"></td><td><pre>  getters<span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> useUserStore<span class="token punctuation">;</span></pre></td></tr></table></figure><ol start="4"><li>登录成功与失败后干什么<br>登录页面 login/index.vue,script 部分</li></ol><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> useRouter <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"vue-router"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> ElNotification <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"element-plus"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">// 获取路由器</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">let</span> $router <span class="token operator">=</span> <span class="token function">useRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">login</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token comment">// 点击登录后干什么？</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token comment">// 通知仓库发登录请求</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token comment">// 请求成功 - 首页 home</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token comment">// 请求失败 - 弹出登录失败信息</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token comment">// 保证登录成功</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">await</span> useStore<span class="token punctuation">.</span><span class="token function">userLogin</span><span class="token punctuation">(</span>loginForm<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token comment">// 编程式导航跳转到 home 首页</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    $router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token comment">// 登陆成功的提示信息</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token function">ElNotification</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>      type<span class="token operator">:</span> <span class="token string">"success"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="20"></td><td><pre>      message<span class="token operator">:</span> <span class="token string">"登录成功"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token function">ElNotification</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>      type<span class="token operator">:</span> <span class="token string">"error"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="25"></td><td><pre>      message<span class="token operator">:</span> <span class="token punctuation">(</span>error <span class="token keyword">as</span> Error<span class="token punctuation">)</span><span class="token punctuation">.</span>message<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure><ol start="5"><li><p>完善小仓库 user.ts 的 ts 类型<br>类型断言等等</p></li><li><p>封装本地存储数据与读取数据方法，用的时候 import 引入就可以直接用</p></li></ol><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">SET_TOKEN</span> <span class="token operator">=</span> <span class="token punctuation">(</span>token<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">"TOKEN"</span><span class="token punctuation">,</span> token<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">GET_TOKEN</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">return</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">"TOKEN"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure><ol start="7"><li>登录时间判断与封装</li></ol><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 封装一个函数：获取一个结果：早上 | 上午 | 下午 | 晚上</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">getTime</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token keyword">let</span> message <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token comment">// 通过内置的构造函数 data 获取时间</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token keyword">let</span> hours <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>hours <span class="token operator">&lt;=</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    message <span class="token operator">=</span> <span class="token string">"早上"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>hours <span class="token operator">&lt;=</span> <span class="token number">12</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    message <span class="token operator">=</span> <span class="token string">"上午"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>hours <span class="token operator">&lt;=</span> <span class="token number">18</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    message <span class="token operator">=</span> <span class="token string">"下午"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    message <span class="token operator">=</span> <span class="token string">"晚上"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre>  <span class="token keyword">return</span> message<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>然后在 login/index.vue 中使用</p><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 引入获取时间的函数</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span>getTime<span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'@/utils/time'</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>……</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 登陆成功的提示信息</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token function">ElNotification</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  type<span class="token operator">:</span><span class="token string">'success'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  message<span class="token operator">:</span><span class="token string">'欢迎回来'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  title<span class="token operator">:</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hi,</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">好</span><span class="token template-punctuation string">`</span></span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr></table></figure><ol start="8"><li>登录模块表单校验<br>（用户名必须大于等于 4 位，密码必须大于等于 6 位）<br>这里使用 element-plus 中 Form 组件自带的表单验证功能： <code>rules</code> 属性<br>要保证所有的表单项校验通过再发请求 <code>validate</code></li></ol><pre><code class="language-vue">&lt;template&gt;
  &lt;el-form class=&quot;login_form&quot; :model=&quot;loginForm&quot; :rules=&quot;rules&quot; ref=&quot;loginForms&quot;&gt;
    &lt;h1&gt;请登录&lt;/h1&gt;
    &lt;el-form-item prop=&quot;username&quot;&gt;
      &lt;el-input :prefix-icon=&quot;User&quot; v-model=&quot;loginForm.username&quot;&gt;&lt;/el-input&gt;
    &lt;/el-form-item&gt;
    &lt;el-form-item prop=&quot;password&quot;&gt;
      &lt;el-input type=&quot;password&quot; :prefix-icon=&quot;Lock&quot; show-password=&quot;true&quot; v-model=&quot;loginForm.password&quot;&gt;&lt;/el-input&gt;
    &lt;/el-form-item&gt;
  &lt;/el-form&gt;
&lt;/template&gt;
&lt;script setup lang=&quot;ts&quot;&gt;
//收集账号与密码的数据
let loginForm = reactive(&#123;
  username: &quot;admin&quot;,
  password: &quot;111111&quot;,
&#125;);
//获取el-form组件
let loginForms = ref();

const login = async () =&gt; &#123;
  //保证所有的表单项校验通过再发请求
  await loginForms.value.validate();
  //点击登录后干什么？
  //通知仓库发登录请求
  //请求成功-首页home
  //请求失败-弹出登录失败信息
  try &#123;
    //保证登录成功
    await useStore.userLogin(loginForm);
    //编程式导航跳转到home首页
    $router.push(&quot;/&quot;);
    //登陆成功的提示信息
    ElNotification(&#123;
      type: &quot;success&quot;,
      message: &quot;欢迎回来&quot;,
      title: `Hi,$&#123;getTime()&#125;好`,
    &#125;);
  &#125; catch (error) &#123;
    ElNotification(&#123;
      type: &quot;error&quot;,
      message: (error as Error).message,
    &#125;);
  &#125;
&#125;;

//定义表单校验需要的配置对象
const rules = &#123;
  username: [
    &#123;
      required: true,
      min: 4,
      max: 10,
      message: &quot;账号长度至少4位&quot;,
      trigger: &quot;change&quot;,
    &#125;,
  ],
  password: [
    &#123;
      required: true,
      min: 6,
      max: 12,
      message: &quot;密码长度至少6位&quot;,
      trigger: &quot;change&quot;,
    &#125;,
  ],
&#125;;
&lt;/script&gt;
</code></pre><h3 id="212-layout或-home路由首页"><a class="anchor" href="#212-layout或-home路由首页">#</a> 2.12 layout (或 home) 路由首页</h3><p>包含：左侧导航菜单，顶部导航，中间内容展示区 (包含许多二级路由)</p><ol><li>搭建骨架，<br>views/layout/index.vue</li></ol><pre><code class="language-vue">&lt;template&gt;
  &lt;div class=&quot;layout_container&quot;&gt;
    &lt;!-- 左侧菜单 --&gt;
    &lt;div class=&quot;layout_slider&quot;&gt;123&lt;/div&gt;
    &lt;!-- 顶部导航 --&gt;
    &lt;div class=&quot;layout_tabbar&quot;&gt;456&lt;/div&gt;
    &lt;!-- 中间内容展示区域 --&gt;
    &lt;div class=&quot;layout_main&quot;&gt;789&lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;&lt;/script&gt;

&lt;style scoped lang=&quot;scss&quot;&gt;
.layout_container &#123;
  width: 100%;
  height: 100vh;
  background: white;

  .layout_slider &#123;
    width: $base-menu-width;
    height: 100vh;
    background: #39c5bb;
  &#125;

  .layout_tabbar &#123;
    position: fixed;
    width: calc(100% - $base-menu-width);
    height: $base-tabbar-height;
    background: pink;
    top: 0px;
    left: $base-menu-width;
  &#125;

  .layout_main &#123;
    position: absolute;
    width: calc(100% - $base-menu-width);
    height: calc(100vh - $base-tabbar-height);
    top: $base-tabbar-height;
    left: $base-menu-width;
    padding: 20px;
    overflow: auto;
  &#125;
&#125;
&lt;/style&gt;
</code></pre><ol start="2"><li>logo 组件封装<br>layout/logo/index.vue:</li></ol><pre><code class="language-vue">&lt;template&gt;
  &lt;div class=&quot;logo&quot;&gt;
    &lt;img src=&quot;../../../../public/logo.png&quot; alt=&quot;&quot; /&gt;
    &lt;p&gt;K.K后台管理系统&lt;/p&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;&lt;/script&gt;

&lt;style scoped lang=&quot;scss&quot;&gt;
.logo &#123;
  width: 100%;
  height: $base-menu-logo-height;
  display: flex;
  align-items: center;
  padding: 20px;
  img &#123;
    width: 40px;
    height: 40px;
  &#125;
  p &#123;
    font-size: $base-logo-title-fontSize;
    margin-left: 10px;
  &#125;
&#125;
&lt;/style&gt;
</code></pre><ol start="3"><li>左侧菜单展示相应的菜单<blockquote><p>左侧的菜单其实就是一些可点击的导航链接，点击后中间的内容展示区域会切换相应的路由<br>我们使用 elementplus 的 menu 组件，但是不能写死，因为到时候要根据用户的路由去形成菜单<br>我们选择将左侧菜单单独封装成一个组件，根据项目的路由去展示菜单项</p></blockquote></li></ol><ul><li>user 仓库引入路由（常量路由） 动态路由是登录后比对用户信息后获取的：<br>store/modules/user.ts:</li></ul><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 引入路由（常量路由） 动态路由是登录后比对用户信息后获取的</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> constantRoute <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'@/router/routes'</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token operator">...</span><span class="token operator">...</span></pre></td></tr><tr><td data-num="5"></td><td><pre>state<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> UserState <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    menuRoutes<span class="token operator">:</span> constantRoute<span class="token punctuation">,</span><span class="token comment">// 仓库存储生成左侧菜单需要的数组 (由)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr></table></figure><ul><li>新建封装 menu 子组件，把路由数据传给 menu 组件<br>layout/index.vue:</li></ul><pre><code class="language-vue">&lt;template&gt;
  &lt;Menu :menuList=&quot;userStore.menuRoutes&quot;&gt;&lt;/Menu&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
//引入左侧菜单组件
import Menu from &quot;./menu/index.vue&quot;;

//获取用户相关的小仓库
import useUserStore from &quot;@/store/modules/user&quot;;
let userStore = useUserStore();
&lt;/script&gt;
</code></pre><ul><li>接下来是 menu 子组件根据路由动态生成菜单：<br>layout/menu/index.vue:</li></ul><pre><code class="language-vue">&lt;template&gt;
  &lt;template v-for=&quot;(item, index) in menuList&quot; :key=&quot;item.path&quot;&gt;
    &lt;!-- 没有子路由 --&gt;
    &lt;el-menu-item v-if=&quot;!item.children&quot; :index=&quot;item.path&quot;&gt;
      &lt;!-- &lt;template #title&gt;：菜单的名字 --&gt;
      &lt;template #title&gt;
        &lt;span&gt;&lt;/span&gt;
        &lt;span&gt;&#123;&#123; item.meta.title &#125;&#125;&lt;/span&gt;
      &lt;/template&gt;
    &lt;/el-menu-item&gt;
    &lt;!-- 有子路由但是只有一个子路由 --&gt;
    &lt;el-menu-item v-if=&quot;item.children &amp;&amp; item.children.length == 1&quot; :index=&quot;item.children[0].path&quot;&gt;
      &lt;template #title&gt;
        &lt;span&gt;&#123;&#123; item.children[0].meta.title &#125;&#125;&lt;/span&gt;
      &lt;/template&gt;
    &lt;/el-menu-item&gt;
    &lt;!-- 有子路由，且个数大于一个 --&gt;
    &lt;el-sub-menu v-if=&quot;item.children &amp;&amp; item.children.length &gt; 1&quot; :index=&quot;item.path&quot;&gt;
      &lt;template #title&gt;
        &lt;span&gt;&#123;&#123; item.meta.title &#125;&#125;&lt;/span&gt;
      &lt;/template&gt;
      &lt;!-- 递归组件：递归一级路由的子路由，展示在这里 --&gt;
      &lt;Menu :menuList=&quot;item.children&quot;&gt;&lt;/Menu&gt;
    &lt;/el-sub-menu&gt;
  &lt;/template&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
//获取父组件传递过来的全部路由数组
defineProps([&quot;menuList&quot;]);
&lt;/script&gt;
&lt;script lang=&quot;ts&quot;&gt;
//为了使用递归组件不报错，起个名字
export default &#123;
  name: &quot;Menu&quot;,
&#125;;
&lt;/script&gt;
</code></pre><ul><li>并不是所有的路由都要在左侧菜单中展示（比如登录路由，你都进来了自然不需要再登录）。因此我们需要告诉组件哪些需要展示哪些不需要展示<blockquote><p>在路由表 router/routes.ts 中路由的路由元信息 <code>meta</code> 中添加 <code>hidden</code> 属性，需要隐藏的就设为 true</p></blockquote></li></ul><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre>meta<span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>      title<span class="token operator">:</span> <span class="token string">"登录"</span><span class="token punctuation">,</span> <span class="token comment">// 菜单标题</span></pre></td></tr><tr><td data-num="3"></td><td><pre>      hidden<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 代表路由标题在菜单中是否隐藏  true: 隐藏 false: 不隐藏</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr></table></figure><ul><li>那么接下来怎么判断显示 / 隐藏？<blockquote><p>再嵌套一层 &lt;template&gt;，把判断是否多层路由放在这里，然后把判断显示隐藏放在里层<br>layout/menu/index.vue:</p></blockquote></li></ul><pre><code class="language-vue">&lt;template&gt;
  &lt;template v-for=&quot;(item, index) in menuList&quot; :key=&quot;item.path&quot;&gt;
    &lt;!-- 没有子路由 --&gt;
    &lt;template v-if=&quot;!item.children&quot;&gt;
      &lt;el-menu-item :index=&quot;item.path&quot; v-if=&quot;!item.meta.hidden&quot;&gt;
        &lt;!-- &lt;template #title&gt;：菜单的名字 --&gt;
        &lt;template #title&gt;
          &lt;span&gt;&lt;/span&gt;
          &lt;span&gt;&#123;&#123; item.meta.title &#125;&#125;&lt;/span&gt;
        &lt;/template&gt;
      &lt;/el-menu-item&gt;
    &lt;/template&gt;
    &lt;!-- 有子路由但是只有一个子路由 --&gt;
    &lt;template v-if=&quot;item.children &amp;&amp; item.children.length == 1&quot;&gt;
      &lt;el-menu-item :index=&quot;item.children[0].path&quot; v-if=&quot;!item.meta.hidden&quot;&gt;
        &lt;template #title&gt;
          &lt;span&gt;&#123;&#123; item.children[0].meta.title &#125;&#125;&lt;/span&gt;
        &lt;/template&gt;
      &lt;/el-menu-item&gt;
    &lt;/template&gt;
    &lt;!-- 有子路由，且个数大于一个 --&gt;
    &lt;template v-if=&quot;item.children &amp;&amp; item.children.length &gt; 1&quot;&gt;
      &lt;el-sub-menu :index=&quot;item.path&quot; v-if=&quot;!item.meta.hidden&quot;&gt;
        &lt;template #title&gt;
          &lt;span&gt;&#123;&#123; item.meta.title &#125;&#125;&lt;/span&gt;
        &lt;/template&gt;
        &lt;!-- 递归组件：递归一级路由的子路由，展示在这里 --&gt;
        &lt;Menu :menuList=&quot;item.children&quot;&gt;&lt;/Menu&gt;
      &lt;/el-sub-menu&gt;
    &lt;/template&gt;
  &lt;/template&gt;
&lt;/template&gt;
</code></pre><ol start="4"><li>菜单图标</li></ol><blockquote><ol><li>把 elementplus 所有图标注册为全局组件<br>components/index.ts:</li></ol></blockquote><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 引入 element-plus 提供的全部图标组件</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> ElementPlusIconsVue <span class="token keyword">from</span> <span class="token string">"@element-plus/icons-vue"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">// 对外暴露插件对象</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token function">install</span><span class="token punctuation">(</span>app<span class="token operator">:</span> App<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>components<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>      app<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> components<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token comment">// 将 element-plus 提供图标注册为全局组件</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span> component<span class="token punctuation">]</span> <span class="token keyword">of</span> Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>ElementPlusIconsVue<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>      app<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> component<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure><blockquote><ol start="2"><li>因为菜单是动态生成，所有图标也不能写死，所有图标信息也要写在路由元信息 <code>meta</code> 中</li></ol></blockquote><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre>meta<span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>   title<span class="token operator">:</span> <span class="token string">"登录"</span><span class="token punctuation">,</span> <span class="token comment">// 菜单标题</span></pre></td></tr><tr><td data-num="3"></td><td><pre>   hidden<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 代表路由标题在菜单中是否隐藏  true: 隐藏 false: 不隐藏</span></pre></td></tr><tr><td data-num="4"></td><td><pre>   icon<span class="token operator">:</span> <span class="token string">"Promotion"</span><span class="token punctuation">,</span> <span class="token comment">// 菜单文字左侧的图标，支持 element-plus 全部图标</span></pre></td></tr><tr><td data-num="5"></td><td><pre> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr></table></figure><blockquote><ol start="3"><li>在 menu 路由中应用 (这里简略写)：<br>layout/menu/index.vue</li></ol></blockquote><pre><code class="language-vue">&lt;!-- 没有子路由 --&gt;
&lt;template #title&gt;
  &lt;!-- 添加图标 --&gt;
  &lt;el-icon&gt;
    &lt;component :is=&quot;item.meta.icon&quot;&gt;&lt;/component&gt;
  &lt;/el-icon&gt;
  &lt;span&gt;&#123;&#123; item.meta.title &#125;&#125;&lt;/span&gt;
&lt;/template&gt;

&lt;!-- 有子路由但是只有一个子路由 --&gt;
&lt;template #title&gt;
  &lt;el-icon&gt;
    &lt;component :is=&quot;item.children[0].meta.icon&quot;&gt;&lt;/component&gt;
  &lt;/el-icon&gt;
  &lt;span&gt;&#123;&#123; item.children[0].meta.title &#125;&#125;&lt;/span&gt;
&lt;/template&gt;
</code></pre><ol start="5"><li><p>项目其他路由配置<br>数据大屏 (一级路由)、权限管理（展示二级路由）、商品管理（展示二级路由）</p></li><li><p>点击菜单时进行路由跳转<br>注册点击事件，进行路由跳转<br>menu 子组件（自己封装的）：</p></li></ol><pre><code class="language-vue">&lt;script setup lang=&quot;ts&quot;&gt;
import &#123; useRouter &#125; from &quot;vue-router&quot;;
//获取父组件传递过来的全部路由数组
defineProps([&quot;menuList&quot;]);

//获取路由器对象
let $router = useRouter();
//点击菜单的回调,vc：传入的参数为组件实例
const goRoute = (vc: any) =&gt; &#123;
  $router.push(vc.index);
&#125;;
&lt;/script&gt;
</code></pre><ol start="7"><li>menu 菜单刷新时不重叠回去<br>使用 el-menu 自带的 api <code>default-active</code></li></ol><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-menu</span> <span class="token attr-name">:default-active</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$route.path<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-menu</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><h3 id="213-中间内容展示区域"><a class="anchor" href="#213-中间内容展示区域">#</a> 2.13 中间内容展示区域</h3><ol><li>封装 main 子组件为中间内容展示区域（不封装也行，这里封装是为了做过渡动画）<blockquote><ul><li>layout/index.vue:</li></ul></blockquote></li></ol><pre><code class="language-vue">&lt;template&gt;
  &lt;!-- 部分省略 --&gt;
  &lt;!-- ……………… --&gt;
  &lt;!-- 中间内容展示区域 --&gt;
  &lt;div class=&quot;layout_main&quot;&gt;
    &lt;Main&gt;&lt;/Main&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
//引入中间内容展示区域子组件（自己封装的）
import Main from &quot;./main/index.vue&quot;;
&lt;/script&gt;
</code></pre><blockquote><ul><li>layout/main/index.vue:</li></ul></blockquote><pre><code class="language-vue">&lt;template&gt;
  &lt;!-- 路由组件出口的位置 --&gt;
  &lt;router-view v-slot=&quot;&#123; Component &#125;&quot;&gt;
    &lt;transition name=&quot;fade&quot;&gt;
      &lt;!-- 渲染layout一级路由组件的子路由 --&gt;
      &lt;component :is=&quot;Component&quot; /&gt;
    &lt;/transition&gt;
  &lt;/router-view&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;&lt;/script&gt;

&lt;style scoped lang=&quot;scss&quot;&gt;
.fade-enter-from &#123;
  opacity: 0;
  transform: scale(0);
&#125;
.fade-enter-active &#123;
  transition: all 0.3s;
&#125;
.fade-enter-to &#123;
  opacity: 1;
  transform: scale(1);
&#125;
&lt;/style&gt;
</code></pre><h3 id="214-顶部-tabbar-导航区域"><a class="anchor" href="#214-顶部-tabbar-导航区域">#</a> 2.14 顶部 tabbar 导航区域</h3><blockquote><p>先分析一下，大体来看顶部导航区域一共分为两个部分：左边和右边<br>左边：折叠按钮、面包屑；右边：刷新按钮、全屏按钮、用户按钮</p></blockquote><ol><li>整体是一个盒子，一左一右，可以用 flex 布局</li></ol><pre><code class="language-vue">&lt;template&gt;
  &lt;div class=&quot;tabbar&quot;&gt;
    &lt;div class=&quot;tabbar_left&quot;&gt;123&lt;/div&gt;
    &lt;div class=&quot;tabbar_right&quot;&gt;456&lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;style scoped lang=&quot;scss&quot;&gt;
.tabbar &#123;
  width: 100%;
  height: 100%;
  display: flex;
  justify-content: space-between;
&#125;
&lt;/style&gt;
</code></pre><ol start="2"><li>基本样式骨架</li></ol><pre><code class="language-vue">&lt;template&gt;
  &lt;div class=&quot;tabbar&quot;&gt;
    &lt;!-- 左侧 --&gt;
    &lt;div class=&quot;tabbar_left&quot;&gt;
      &lt;!-- 折叠按钮 --&gt;
      &lt;el-icon style=&quot;margin-right: 10px&quot;&gt;&lt;Expand /&gt;&lt;/el-icon&gt;
      &lt;!-- 面包屑组件 --&gt;
      &lt;el-breadcrumb separator-icon=&quot;ArrowRight&quot;&gt;
        &lt;el-breadcrumb-item&gt;权限管理&lt;/el-breadcrumb-item&gt;
        &lt;el-breadcrumb-item&gt;用户管理&lt;/el-breadcrumb-item&gt;
      &lt;/el-breadcrumb&gt;
    &lt;/div&gt;
    &lt;!-- 右侧 --&gt;
    &lt;div class=&quot;tabbar_right&quot;&gt;
      &lt;el-button size=&quot;small&quot; icon=&quot;Refresh&quot; circle&gt;&lt;/el-button&gt;
      &lt;el-button size=&quot;small&quot; icon=&quot;FullScreen&quot; circle&gt;&lt;/el-button&gt;
      &lt;el-button size=&quot;small&quot; icon=&quot;Setting&quot; circle&gt;&lt;/el-button&gt;
      &lt;img src=&quot;&quot; style=&quot;width: 24px; height: 24px; margin: 0 10px&quot; /&gt;
      &lt;!-- 下拉菜单 --&gt;
      &lt;el-dropdown&gt;
        &lt;span class=&quot;el-dropdown-link&quot;&gt;
          admin
          &lt;el-icon class=&quot;el-icon--right&quot;&gt;
            &lt;arrow-down /&gt;
          &lt;/el-icon&gt;
        &lt;/span&gt;
        &lt;template #dropdown&gt;
          &lt;el-dropdown-menu&gt;
            &lt;el-dropdown-item&gt;退出登录&lt;/el-dropdown-item&gt;
          &lt;/el-dropdown-menu&gt;
        &lt;/template&gt;
      &lt;/el-dropdown&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;&lt;/script&gt;

&lt;style scoped lang=&quot;scss&quot;&gt;
.tabbar &#123;
  width: 100%;
  height: 100%;
  display: flex;
  justify-content: space-between;

  .tabbar_left &#123;
    display: flex;
    align-items: center; //垂直居中
    margin-left: 20px;
  &#125;
  .tabbar_right &#123;
    display: flex;
    align-items: center; //垂直居中
  &#125;
&#125;
&lt;/style&gt;
</code></pre><ol start="3"><li>菜单折叠效果实现<blockquote><ul><li>点击按钮图标切换：要定义一个响应式数据控制图标切换，绑定方法</li></ul></blockquote></li></ol><pre><code class="language-vue">&lt;template&gt;
  &lt;!-- 折叠按钮 --&gt;
  &lt;el-icon style=&quot;margin-right: 10px&quot; @click=&quot;changeIcon&quot;&gt;
    &lt;component :is=&quot;fold ? 'Fold' : 'Expand'&quot;&gt;&lt;/component&gt;
  &lt;/el-icon&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import &#123; ref &#125; from &quot;vue&quot;;
//定义一个响应式数据控制图标切换
let fold = ref(false);
//点击图标的方法
const changeIcon = () =&gt; &#123;
  fold.value = !fold.value;
&#125;;
&lt;/script&gt;
</code></pre><blockquote><ul><li>因为顶部导航 tabbar 的按钮想要控制左侧菜单 slider 的折叠与展开（控制其宽度），所以需要用的组件间通信<br>store/modules/setting.ts 新建小仓库，将数据挂载到仓库上</li></ul></blockquote><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 小仓库：layout 组件相关配置仓库</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> defineStore <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"pinia"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">// 引入数据类型</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">&#123;</span> loginForm<span class="token punctuation">,</span> loginResponseData <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"@/api/user/type"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">// 创建小仓库</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">let</span> useLayoutSettingStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">"SettingStore"</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token comment">// 小仓库存储数据的地方</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token function-variable function">state</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>      fold<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 用于控制左侧菜单折叠 / 展开</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  <span class="token comment">// 处理异步 | 逻辑的地方</span></pre></td></tr><tr><td data-num="16"></td><td><pre>  actions<span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="17"></td><td><pre>  getters<span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> useLayoutSettingStore<span class="token punctuation">;</span></pre></td></tr></table></figure><p>之前 tabbar/index.vue 的代码也要发生改变</p><pre><code class="language-vue">&lt;template&gt;
  &lt;!-- 折叠按钮 --&gt;
  &lt;el-icon style=&quot;margin-right: 10px&quot; @click=&quot;changeIcon&quot;&gt;
    &lt;component :is=&quot;LayoutSettingStore.fold ? 'Fold' : 'Expand'&quot;&gt;&lt;/component&gt;
  &lt;/el-icon&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import useLayoutSettingStore from &quot;@/store/modules/setting&quot;;
//获取仓库
let LayoutSettingStore = useLayoutSettingStore();

//点击图标的方法
const changeIcon = () =&gt; &#123;
  LayoutSettingStore.fold = !LayoutSettingStore.fold;
&#125;;
&lt;/script&gt;
</code></pre><p>接下来回到 “爷爷组件” layout/index.vue 组件中实现折叠效果（动态控制宽度）:</p><pre><code class="language-vue">&lt;template&gt;
  &lt;div class=&quot;layout_container&quot;&gt;
    &lt;!-- 左侧菜单 --&gt;
    &lt;div class=&quot;layout_slider&quot; :class=&quot;&#123; fold: LayoutSettingStore.fold ? true : false &#125;&quot;&gt;
      &lt;Logo&gt;&lt;/Logo&gt;
      &lt;!-- 展示菜单 --&gt;
      &lt;!-- elementplus的菜单组件 --&gt;
      &lt;el-menu :collapse=&quot;LayoutSettingStore.fold ? true : false&quot; :default-active=&quot;$route.path&quot; background-color=&quot;#39c5bb&quot; text-color=&quot;white&quot;&gt;
        &lt;!-- 根据路由动态生成菜单 --&gt;
        &lt;Menu :menuList=&quot;userStore.menuRoutes&quot;&gt;&lt;/Menu&gt;
      &lt;/el-menu&gt;
    &lt;/div&gt;
    &lt;!-- 顶部导航 --&gt;
    &lt;div class=&quot;layout_tabbar&quot; :class=&quot;&#123; fold: LayoutSettingStore.fold ? true : false &#125;&quot;&gt;
      &lt;Tabbar&gt;&lt;/Tabbar&gt;
    &lt;/div&gt;
    &lt;!-- 中间内容展示区域 --&gt;
    &lt;div class=&quot;layout_main&quot; :class=&quot;&#123; fold: LayoutSettingStore.fold ? true : false &#125;&quot;&gt;
      &lt;Main&gt;&lt;/Main&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
//获取layout配置小仓库
import useLayoutSettingStore from &quot;@/store/modules/setting&quot;;
let LayoutSettingStore = useLayoutSettingStore();
&lt;/script&gt;

&lt;style scoped lang=&quot;scss&quot;&gt;
.layout_container &#123;
  width: 100%;
  height: 100vh;

  .layout_slider &#123;
    color: white;
    width: $base-menu-width;
    height: 100vh;
    background: $base-menu-background;
    transition: all 0.3s;
    .el-menu &#123;
      border-right: none;
    &#125;
    &amp;.fold &#123;
      width: $base-menu-min-width;
    &#125;
  &#125;

  .layout_tabbar &#123;
    position: fixed;
    width: calc(100% - $base-menu-width);
    height: $base-tabbar-height;
    top: 0px;
    left: $base-menu-width;
    border-bottom: 1px solid;
    transition: all 0.3s;

    &amp;.fold &#123;
      width: calc(100vw - $base-menu-min-width);
      left: $base-menu-min-width;
    &#125;
  &#125;

  .layout_main &#123;
    position: absolute;
    width: calc(100% - $base-menu-width);
    height: calc(100vh - $base-tabbar-height);
    top: $base-tabbar-height;
    left: $base-menu-width;
    padding: 20px;
    overflow: auto;
    transition: all 0.3s;

    &amp;.fold &#123;
      width: calc(100vw - $base-menu-min-width);
      left: $base-menu-min-width;
    &#125;
  &#125;
&#125;
&lt;/style&gt;
</code></pre><ol start="4"><li>顶部面包屑动态展示</li></ol><ul><li><p>面包屑需要动态展示路由的名字与标题：通过路由对象 $route.matched 属性，根据匹配到的路由动态生成<br><code>matched</code> 属性可以获取当前匹配到的路由</p></li><li><p>点击面包屑可跳转对应路由<br>借助 elementplus 面包屑 breadcrumb 组件自带的 to 属性</p></li></ul><pre><code class="language-vue">&lt;template&gt;
  &lt;!-- 面包屑组件 --&gt;
  &lt;el-breadcrumb separator-icon=&quot;ArrowRight&quot;&gt;
    &lt;!-- 面包屑需要动态展示路由的名字与标题：通过路由对象$route.matched属性，根据匹配到的路由动态生成 --&gt;
    &lt;el-breadcrumb-item v-for=&quot;(item, index) in $route.matched&quot; :key=&quot;index&quot; v-show=&quot;item.meta.title&quot; :to=&quot;item.path&quot;&gt;
      &lt;span&gt;&#123;&#123; item.meta.title &#125;&#125;&lt;/span&gt;
    &lt;/el-breadcrumb-item&gt;
  &lt;/el-breadcrumb&gt;
&lt;/template&gt;
</code></pre><ol start="5"><li>刷新功能实现<br>涉及到组件间的通信<br>在 layout 相关小仓库中的 state 中新声明一个变量，用于保存刷新按钮的状态，一旦点击刷新按钮，状态就会发生变化，而 main 路由组件一旦监听（watch）到其发生变化，就会进行路由组件销毁<br>store/modules/setting.ts:</li></ol><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 小仓库存储数据的地方</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token function-variable function">state</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>      refresh<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token comment">// 用于控制刷新效果</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>layout/tabbar/index.vue:</p><pre><code class="language-vue">&lt;template&gt;
  &lt;!-- 刷新按钮 --&gt;
  &lt;el-button size=&quot;small&quot; icon=&quot;Refresh&quot; circle @click=&quot;updateRefsh&quot;&gt;&lt;/el-button&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
//刷新按钮点击的回调
const updateRefsh = () =&gt; &#123;
  LayoutSettingStore.refresh = !LayoutSettingStore.refresh;
&#125;;
&lt;/script&gt;
</code></pre><p>layout/mian/index.vue</p><pre><code class="language-vue">&lt;template&gt;
  &lt;!-- 路由组件出口的位置 --&gt;
  &lt;router-view v-slot=&quot;&#123; Component &#125;&quot;&gt;
    &lt;transition name=&quot;fade&quot;&gt;
      &lt;!-- 渲染layout一级路由组件的子路由 --&gt;
      &lt;component :is=&quot;Component&quot; v-if=&quot;flag&quot; /&gt;
    &lt;/transition&gt;
  &lt;/router-view&gt;
&lt;/template&gt;
&lt;script setup lang=&quot;ts&quot;&gt;
import &#123; watch, ref, nextTick &#125; from &quot;vue&quot;;
import useLayoutSettingStore from &quot;@/store/modules/setting&quot;;

//获取仓库
let LayoutSettingStore = useLayoutSettingStore();

//控制当前路由组件是否销毁重建
let flag = ref(true);

//监听仓库内部的数据是否发生变化，如果发生变化，说明用户点击过刷新按钮
watch(
  () =&gt; LayoutSettingStore.refresh,
  () =&gt; &#123;
    //点击刷新按钮：路由组件销毁
    flag.value = false;
    //销毁完毕之后再创建
    nextTick(() =&gt; &#123;
      flag.value = true;
    &#125;);
  &#125;
);
&lt;/script&gt;
</code></pre><ol start="6"><li>全屏切换功能实现</li></ol><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 全屏按钮点击的回调</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">fullScreen</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token comment">//DOM 对象的一个属性：可以用来当前是否为全屏模式 [全屏：ture，不是全屏：false]</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token keyword">let</span> full <span class="token operator">=</span> document<span class="token punctuation">.</span>fullscreenElement<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>full<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token comment">// 文档根节点的 requestFullscreen 方法实现全屏</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span><span class="token function">requestFullscreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token comment">// 退出全屏模式</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    document<span class="token punctuation">.</span><span class="token function">exitFullscreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure><ol start="7"><li><p>获取用户信息与 token</p><blockquote><p>前台 ——&gt; 后台 ——&gt; 数据库 ——&gt; 后台 ——&gt; 前台<br>JWT:JsonWebToken<br><img data-src="https://eucli-1314359160.cos.ap-beijing.myqcloud.com/test/I%5DI9A7BV1JB%7BNI7Y733" alt="">2AQ.png)</p><ol><li>通过请求拦截器的请求头，给服务器携带公共参数<br>utils/request.ts：</li></ol></blockquote><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 引入用户相关的仓库</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> useUserStore <span class="token keyword">from</span> <span class="token string">"@/store/modules/user"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// 使用请求拦截器</span></pre></td></tr><tr><td data-num="4"></td><td><pre>request<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token comment">//config 配置对象具有 headers 请求头属性，经常给服务器端携带公共参数</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token comment">// 获取用户相关的小仓库：获取仓库内部的 token，登陆成功后携带给服务 器</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token keyword">let</span> userStore <span class="token operator">=</span> <span class="token function">useUserStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>userStore<span class="token punctuation">.</span>token<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    config<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>token <span class="token operator">=</span> userStore<span class="token punctuation">.</span>token<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token comment">// 返回配置对象</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token keyword">return</span> config<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><blockquote><ol start="2"><li>登录成功后用户信息存储于仓库当中，方便调用<br>store/modules/user.ts:</li></ol></blockquote><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 引入接口</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span>reqUserInfo <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"@/api/user"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>state<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> UserState <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    token<span class="token operator">:</span> <span class="token constant">GET_TOKEN</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 用户唯一标识 token</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    menuRoutes<span class="token operator">:</span> constantRoute<span class="token punctuation">,</span><span class="token comment">// 仓库存储生成左侧菜单需要的数组 (路 由)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    username<span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    avatar<span class="token operator">:</span><span class="token string">''</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>actions<span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token comment">// 获取用户信息方法</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token keyword">async</span> <span class="token function">userInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token comment">// 获取用户的信息 [头像、名字] 存储仓库当中</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">let</span> result <span class="token operator">=</span>  <span class="token keyword">await</span> <span class="token function">reqUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>          <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>      <span class="token keyword">this</span><span class="token punctuation">.</span>username <span class="token operator">=</span> result<span class="token punctuation">.</span>data<span class="token punctuation">.</span>checkUser<span class="token punctuation">.</span>username<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>      <span class="token keyword">this</span><span class="token punctuation">.</span>avatar <span class="token operator">=</span> result<span class="token punctuation">.</span>data<span class="token punctuation">.</span>checkUser<span class="token punctuation">.</span>avatar<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr></table></figure><blockquote><ol start="3"><li>首页加载完毕后获取用户信息<br>layout/home/index.vue</li></ol></blockquote><pre><code class="language-vue">&lt;template&gt;
  &lt;h1&gt;我是home首页&lt;/h1&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import &#123; onMounted &#125; from &quot;vue&quot;;
//获取仓库
import useUserStore from &quot;@/store/modules/user&quot;;
let userStore = useUserStore();
//首页挂载完毕获取用户信息
onMounted(() =&gt; &#123;
  userStore.userInfo();
&#125;);
&lt;/script&gt;
</code></pre><blockquote><ol start="4"><li>tabbar 组件获取用户信息，动态展示头像和名字</li></ol></blockquote></li><li><p>退出登录业务功能<br>退出登录时需要做的事情：发退出登录请求，清除 token，跳转登录页面</p></li></ol><ul><li>layout/tabbar/index.vue:</li></ul><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 退出登录</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">logout</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token comment">// 第一件事：需要向服务器发请求（目前没有退出登录接口）</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token comment">// 第二件事：仓库当中关于用户相关的数据要清除掉</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  userStore<span class="token punctuation">.</span><span class="token function">userLogout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token comment">// 第三件事：跳转到登录页面</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  $router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">"/login"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure><ul><li>store/modules/user.ts:</li></ul><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 退出登录</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token function">userLogout</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>      <span class="token comment">// 目前没有 mock 接口：退出登录接口（通知服务器本次用户的唯一标识失效）</span></pre></td></tr><tr><td data-num="4"></td><td><pre>      <span class="token comment">// 清除 store 仓库中存储的用户相关信息</span></pre></td></tr><tr><td data-num="5"></td><td><pre>      <span class="token keyword">this</span><span class="token punctuation">.</span>token <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>      <span class="token keyword">this</span><span class="token punctuation">.</span>username <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>      <span class="token keyword">this</span><span class="token punctuation">.</span>avatar <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>      <span class="token comment">// 本地存储中的 token 也需要清除掉</span></pre></td></tr><tr><td data-num="9"></td><td><pre>      <span class="token constant">REMOVE_TOKEN</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr></table></figure><h3 id="215-路由守卫路由鉴权"><a class="anchor" href="#215-路由守卫路由鉴权">#</a> 2.15 路由守卫 | 路由鉴权</h3><ol><li>路由鉴权之进度条业务<br>利用路由守卫</li></ol><ul><li>1.1 新建 <code>permission.ts</code> 鉴权文件进行路由守卫的设置<br>src/router/permission.ts:</li></ul><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 路由鉴权 鉴权：项目中的路由能不能被访问的权限的设置</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">"@/router"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">// 全局守卫：项目中任一路由的切换都会触发的钩子</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 全局前置守卫</span></pre></td></tr><tr><td data-num="6"></td><td><pre>router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">// 全局后置守卫</span></pre></td></tr><tr><td data-num="9"></td><td><pre>router<span class="token punctuation">.</span><span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> from<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><ul><li>1.2 入口文件 main.ts 当中引入 permission.ts</li></ul><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 引入鉴权文件</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> <span class="token string">"./router/permission"</span><span class="token punctuation">;</span></pre></td></tr></table></figure><ul><li>1.3 安装进度条插件</li></ul><figure class="highlight yaml"><figcaption data-lang="YAML"></figcaption><table><tr><td data-num="1"></td><td><pre>pnpm i nprogress</pre></td></tr></table></figure><ul><li>1.4 引入进度条并使用</li></ul><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 路由鉴权 鉴权：项目中的路由能不能被访问的权限的设置</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">"@/router"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// 引入进度条</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">import</span> nprogress <span class="token keyword">from</span> <span class="token string">"nprogress"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">import</span> <span class="token string">"nprogress/nprogress.css"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">// 全局守卫：项目中任一路由的切换都会触发的钩子</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">// 全局前置守卫</span></pre></td></tr><tr><td data-num="9"></td><td><pre>router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token comment">// 访问某一个路由之前的守卫</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  nprogress<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment">// 全局后置守卫</span></pre></td></tr><tr><td data-num="16"></td><td><pre>router<span class="token punctuation">.</span><span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> from<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>  nprogress<span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><ol start="2"><li>路由鉴权<blockquote><p>全部的路由组件：登录 | 404 | 任意路由 | 首页（二级）| 数据大屏 | 权限管理（三个子路由）| 商品管理（四个子路由）</p></blockquote></li></ol><blockquote><p>用户未登录可以访问的路由：login，其余的不能访问（指向 login）</p></blockquote><blockquote><p>用户登录后可以访问的路由：不可以访问 login（指向首页），其他都可以访问</p></blockquote><ul><li>可以根据仓库当中的 token 去判断用户是否登录:</li></ul><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 路由鉴权：鉴权，项目当中路由能不能被的权限的设置 (某一个路由什么条件下可以访问、什么条件下不可以访问)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">"@/router"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">//@ts-ignore</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">import</span> nprogress <span class="token keyword">from</span> <span class="token string">"nprogress"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 引入进度条样式</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">import</span> <span class="token string">"nprogress/nprogress.css"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">// 取消加载小圆圈</span></pre></td></tr><tr><td data-num="8"></td><td><pre>nprogress<span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> showSpinner<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">// 获取用户相关的小仓库内部 token 数据，去判断用户是否登录成功</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">import</span> useUserStore <span class="token keyword">from</span> <span class="token string">"@/store/modules/user"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">import</span> pinia <span class="token keyword">from</span> <span class="token string">"../store/index"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">const</span> userStore <span class="token operator">=</span> <span class="token function">useUserStore</span><span class="token punctuation">(</span>pinia<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment">// 全局守卫：项目当中任意路由切换都会触发的钩子</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">// 全局前置守卫</span></pre></td></tr><tr><td data-num="15"></td><td><pre>router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span>to<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> from<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> next<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>  document<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">K.K后台 - </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>to<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>title<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>  <span class="token comment">//to: 你将要访问那个路由</span></pre></td></tr><tr><td data-num="18"></td><td><pre>  <span class="token comment">//from: 你从来个路由而来</span></pre></td></tr><tr><td data-num="19"></td><td><pre>  <span class="token comment">//next: 路由的放行函数</span></pre></td></tr><tr><td data-num="20"></td><td><pre>  nprogress<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>  <span class="token comment">// 获取 token, 去判断用户登录、还是未登录</span></pre></td></tr><tr><td data-num="22"></td><td><pre>  <span class="token keyword">const</span> token <span class="token operator">=</span> userStore<span class="token punctuation">.</span>token<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>  <span class="token comment">// 获取用户名字</span></pre></td></tr><tr><td data-num="24"></td><td><pre>  <span class="token keyword">const</span> username <span class="token operator">=</span> userStore<span class="token punctuation">.</span>username<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>  <span class="token comment">// 用户登录判断</span></pre></td></tr><tr><td data-num="26"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>token<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token comment">// 登录成功，访问 login, 不能访问，指向首页</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>path <span class="token operator">==</span> <span class="token string">"/login"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>      <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> path<span class="token operator">:</span> <span class="token string">"/"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>      <span class="token comment">// 登录成功访问其余六个路由 (登录排除)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>      <span class="token comment">// 有用户信息</span></pre></td></tr><tr><td data-num="33"></td><td><pre>      <span class="token keyword">if</span> <span class="token punctuation">(</span>username<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>        <span class="token comment">// 放行</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>      <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>        <span class="token comment">// 如果没有用户信息，在守卫这里发请求获取到了用户信息再放行</span></pre></td></tr><tr><td data-num="38"></td><td><pre>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>          <span class="token comment">// 获取用户信息</span></pre></td></tr><tr><td data-num="40"></td><td><pre>          <span class="token keyword">await</span> userStore<span class="token punctuation">.</span><span class="token function">userInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>          <span class="token comment">// 放行</span></pre></td></tr><tr><td data-num="42"></td><td><pre>          <span class="token comment">// 万一：刷新的时候是异步路由，有可能获取到用户信息、异步路由还没有加载完毕，出现空白的效果</span></pre></td></tr><tr><td data-num="43"></td><td><pre>          <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token operator">...</span>to <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>          <span class="token comment">//token 过期：获取不到用户信息了</span></pre></td></tr><tr><td data-num="46"></td><td><pre>          <span class="token comment">// 用户手动修改本地存储 token</span></pre></td></tr><tr><td data-num="47"></td><td><pre>          <span class="token comment">// 退出登录 -> 用户相关的数据清空</span></pre></td></tr><tr><td data-num="48"></td><td><pre>          <span class="token keyword">await</span> userStore<span class="token punctuation">.</span><span class="token function">userLogout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>          <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> path<span class="token operator">:</span> <span class="token string">"/login"</span><span class="token punctuation">,</span> query<span class="token operator">:</span> <span class="token punctuation">&#123;</span> redirect<span class="token operator">:</span> to<span class="token punctuation">.</span>path <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>      <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="54"></td><td><pre>    <span class="token comment">// 用户未登录判断</span></pre></td></tr><tr><td data-num="55"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>path <span class="token operator">==</span> <span class="token string">"/login"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>      <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="57"></td><td><pre>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="58"></td><td><pre>      <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> path<span class="token operator">:</span> <span class="token string">"/login"</span><span class="token punctuation">,</span> query<span class="token operator">:</span> <span class="token punctuation">&#123;</span> redirect<span class="token operator">:</span> to<span class="token punctuation">.</span>path <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="59"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="60"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="61"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="62"></td><td><pre><span class="token comment">// 全局后置守卫</span></pre></td></tr><tr><td data-num="63"></td><td><pre>router<span class="token punctuation">.</span><span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>to<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> from<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="64"></td><td><pre>  nprogress<span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="65"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="66"></td><td><pre></pre></td></tr><tr><td data-num="67"></td><td><pre><span class="token comment">// 第一个问题：任意路由切换实现进度条业务 ---nprogress</span></pre></td></tr><tr><td data-num="68"></td><td><pre><span class="token comment">// 第二个问题：路由鉴权 (路由组件访问权限的设置)</span></pre></td></tr><tr><td data-num="69"></td><td><pre><span class="token comment">// 全部路由组件：登录 | 404 | 任意路由 | 首页 | 数据大屏 | 权限管理 (三个子路由)| 商品管理 (四个子路由)</span></pre></td></tr><tr><td data-num="70"></td><td><pre></pre></td></tr><tr><td data-num="71"></td><td><pre><span class="token comment">// 用户未登录：可以访问 login, 其余六个路由不能访问 (指向 login)</span></pre></td></tr><tr><td data-num="72"></td><td><pre><span class="token comment">// 用户登录成功：不可以访问 login [指向首页], 其余的路由可以访问</span></pre></td></tr></table></figure><blockquote><p>报错：&quot;getActivePinia ()&quot; was called but there was no active Pinia.<br>解决：看上面代码</p></blockquote><h3 id="216-接口"><a class="anchor" href="#216-接口">#</a> 2.16 接口</h3><p>使用真实接口代替 mock 接口</p><ol><li>解决跨域问题<br>vite.config.ts:</li></ol><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> loadEnv <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"vite"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> command<span class="token punctuation">,</span> mode <span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token comment">// 获取各种环境下对应的变量</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token keyword">let</span> env <span class="token operator">=</span> <span class="token function">loadEnv</span><span class="token punctuation">(</span>mode<span class="token punctuation">,</span> process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">return</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token comment">//………………</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token comment">// 代理跨域</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    server<span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>      proxy<span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token punctuation">[</span>env<span class="token punctuation">.</span><span class="token constant">VITE_APP_BASE_API</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>          target<span class="token operator">:</span> env<span class="token punctuation">.</span><span class="token constant">VITE_SERVE</span><span class="token punctuation">,</span> <span class="token comment">// 获取数据的服务器地址设置</span></pre></td></tr><tr><td data-num="13"></td><td><pre>          changeOrigin<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 代理跨域</span></pre></td></tr><tr><td data-num="14"></td><td><pre>          <span class="token function-variable function">rewrite</span><span class="token operator">:</span> <span class="token punctuation">(</span>path<span class="token punctuation">)</span> <span class="token operator">=></span> path<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\/api</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 路径重写，把 `/api` 替换为 ''</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="16"></td><td><pre>      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="18"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><ol start="2"><li>替换 api<br>api/user/index.ts:</li></ol><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 统一管理项目用户相关的接口</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> request <span class="token keyword">from</span> <span class="token string">"@/utils/request"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// 项目用户相关的请求地址</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">enum</span> <span class="token constant">API</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token constant">LOGIN_URL</span> <span class="token operator">=</span> <span class="token string">"/admin/acl/index/login"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token constant">USERINFO_URL</span> <span class="token operator">=</span> <span class="token string">"admin/acl/index/info"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token constant">LOGOUT_URL</span> <span class="token operator">=</span> <span class="token string">"admin/acl/index/logout"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment">// 登录接口</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">reqLogin</span> <span class="token operator">=</span> <span class="token punctuation">(</span>data<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=></span> request<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">post</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token constant">API</span><span class="token punctuation">.</span><span class="token constant">LOGIN_URL</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment">// 获取用户信息</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">reqUserInfo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> request<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">get</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token constant">API</span><span class="token punctuation">.</span><span class="token constant">USERINFO_URL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment">// 退出登录</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">reqLogout</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> request<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">post</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token constant">API</span><span class="token punctuation">.</span><span class="token constant">LOGOUT_URL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>store/modules/user.ts 相应更改<br>layout/tabbar/index.vue 的退出登录加 async、await</p><ol start="3"><li>接口 ts 类型定义</li></ol><h3 id="217-商品管理-品牌管理"><a class="anchor" href="#217-商品管理-品牌管理">#</a> 2.17 商品管理 - 品牌管理</h3><h4 id="1-静态模块搭建与模块数据展示"><a class="anchor" href="#1-静态模块搭建与模块数据展示">#</a> 1. 静态模块搭建与模块数据展示</h4><p>views/product/trademark:</p><pre><code class="language-vue">&lt;template&gt;
  &lt;div&gt;
    &lt;el-card class=&quot;box-card&quot;&gt;
      &lt;!-- 卡片顶部添加品牌按钮 --&gt;
      &lt;el-button type=&quot;primary&quot; size=&quot;default&quot; icon=&quot;Plus&quot; @click=&quot;&quot;&gt;添加品牌&lt;/el-button&gt;
      &lt;!-- 表格组件：用于展示已有的品牌的数据--&gt;
      &lt;el-table style=&quot;margin: 10px 0&quot; border&gt;
        &lt;el-table-column label=&quot;序号&quot; width=&quot;80px&quot; align=&quot;center&quot;&gt; &lt;/el-table-column&gt;
        &lt;el-table-column label=&quot;品牌名称&quot;&gt; &lt;/el-table-column&gt;
        &lt;el-table-column label=&quot;品牌LOGO&quot;&gt; &lt;/el-table-column&gt;
        &lt;el-table-column label=&quot;品牌操作&quot;&gt; &lt;/el-table-column&gt;
      &lt;/el-table&gt;
      &lt;!-- 分页器组件 --&gt;
      &lt;el-pagination v-model:current-page=&quot;pageNo&quot; v-model:page-size=&quot;limit&quot; :page-sizes=&quot;[3, 5, 7, 9]&quot; :background=&quot;true&quot; layout=&quot; prev, pager, next, jumper, -&gt;,sizes,total&quot; :total=&quot;400&quot; /&gt;
    &lt;/el-card&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
//引入组合式API函数ref
import &#123; ref &#125; from &quot;vue&quot;;
//当前页码
let pageNo = ref&lt;number&gt;(1);
//每一页展示多少条数据
let limit = ref&lt;number&gt;(3);
&lt;/script&gt;

&lt;style scoped lang=&quot;less&quot;&gt;&lt;/style&gt;
</code></pre><h4 id="2-ts-类型定义"><a class="anchor" href="#2-ts-类型定义">#</a> 2. ts 类型定义</h4><ol><li>发请求获取商品数据<br>api/product/trademark/index.ts:</li></ol><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 书写品牌管理模块的接口</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> request <span class="token keyword">from</span> <span class="token string">"@/utils/request"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// 品牌管理模块接口地址</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">enum</span> <span class="token constant">API</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token comment">// 获取已有品牌接口</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token constant">TRADEMARK_URL</span> <span class="token operator">=</span> <span class="token string">"/admin/product/baseTrademark/"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">// 获取已有品牌的接口方法</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">// 需要携带两个参数：</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment">//page: 获取第几页的数据，默认第一页</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">//limit: 获取几个已有品牌的数据</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">reqHasTrademark</span> <span class="token operator">=</span> <span class="token punctuation">(</span>page<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> limit<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=></span> request<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">get</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token constant">API</span><span class="token punctuation">.</span><span class="token constant">TRADEMARK_URL</span> <span class="token operator">+</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>page<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>limit<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><ol start="2"><li>在商品管理组件内调用 api 接口，发请求获取数据并在页面上动态展示：</li></ol><pre><code class="language-vue">&lt;template&gt;
  &lt;div&gt;
    &lt;el-card class=&quot;box-card&quot;&gt;
      &lt;!-- 卡片顶部添加品牌按钮 --&gt;
      &lt;el-button type=&quot;primary&quot; size=&quot;default&quot; icon=&quot;Plus&quot; @click=&quot;&quot;&gt;添加品牌&lt;/el-button&gt;
      &lt;!-- 表格组件：用于展示已有的品牌的数据--&gt;
      &lt;el-table style=&quot;margin: 10px 0&quot; border :data=&quot;trademarkArr&quot;&gt;
        &lt;el-table-column label=&quot;序号&quot; width=&quot;80px&quot; align=&quot;center&quot; type=&quot;index&quot;&gt; &lt;/el-table-column&gt;
        &lt;el-table-column label=&quot;品牌名称&quot; prop=&quot;tmName&quot;&gt; &lt;/el-table-column&gt;
        &lt;el-table-column label=&quot;品牌LOGO&quot;&gt;
          &lt;template #=&quot;&#123; row, $index &#125;&quot;&gt;
            &lt;img :src=&quot;row.logoUrl&quot; style=&quot;width: 100px; height: 100px&quot; /&gt;
          &lt;/template&gt;
        &lt;/el-table-column&gt;
        &lt;el-table-column label=&quot;品牌操作&quot;&gt;
          &lt;template #=&quot;&#123; row, $index &#125;&quot;&gt;
            &lt;el-button type=&quot;primary&quot; size=&quot;small&quot; icon=&quot;Edit&quot;&gt;&lt;/el-button&gt;
            &lt;el-button type=&quot;primary&quot; size=&quot;small&quot; icon=&quot;Delete&quot;&gt;&lt;/el-button&gt;
          &lt;/template&gt;
        &lt;/el-table-column&gt;
      &lt;/el-table&gt;
      &lt;!-- 分页器组件 --&gt;
      &lt;el-pagination v-model:current-page=&quot;pageNo&quot; v-model:page-size=&quot;limit&quot; :page-sizes=&quot;[3, 5, 7, 9]&quot; :background=&quot;true&quot; layout=&quot; prev, pager, next, jumper, -&gt;,sizes,total&quot; :total=&quot;total&quot; /&gt;
    &lt;/el-card&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
//引入组合式API函数ref
import &#123; ref, onMounted &#125; from &quot;vue&quot;;
import &#123; reqHasTrademark &#125; from &quot;@/api/product/trademark&quot;;
//当前页码
let pageNo = ref&lt;number&gt;(1);
//每一页展示多少条数据
let limit = ref&lt;number&gt;(3);
//存储已有品牌数据的总数
let total = ref&lt;number&gt;(0);
//存储已有品牌的数据
let trademarkArr = ref&lt;any&gt;([]);
//获取已有品牌的接口封装为一个函数：这样做就可以在想获取数据的情况下调用函数即可
const getHsaTrademark = async () =&gt; &#123;
  let result = await reqHasTrademark(pageNo.value, limit.value);
  if (result.code == 200) &#123;
    //存储已有品牌的总个数
    total.value = result.data.total;
    trademarkArr.value = result.data.records;
  &#125;
&#125;;

//组件挂在完毕的钩子————发一次请求获取数据
onMounted(() =&gt; &#123;
  getHsaTrademark();
&#125;);
&lt;/script&gt;

&lt;style scoped lang=&quot;less&quot;&gt;&lt;/style&gt;
</code></pre><ol start="3"><li><code>获取商品数据</code> 的 ts 类型：</li></ol><ul><li>定义类型（ api/product/trademark/type.ts）:</li></ul><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 公共的类型：</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">ResponseData</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  code<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  message<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  ok<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">// 已有的品牌的 ts 数据类型</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">Trademark</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  id<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  tmName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  logoUrl<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment">// 包含全部品牌数据的 ts 类型</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">Records</span> <span class="token operator">=</span> Trademark<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment">// 包含全部品牌的 ts 类型</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">TrademarkResponseData</span> <span class="token keyword">extends</span> <span class="token class-name">ResponseData</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>  data<span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    records<span class="token operator">:</span> Records<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    total<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    size<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    current<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    searchCount<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    pages<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><ul><li>引入使用类型（ api/product/trademark/index.ts）</li></ul><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 书写品牌管理模块的接口</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> request <span class="token keyword">from</span> <span class="token string">"@/utils/request"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">&#123;</span> TrademarkResponseData <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"./type"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">// 品牌管理模块接口地址</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">enum</span> <span class="token constant">API</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token comment">// 获取已有品牌接口</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token constant">TRADEMARK_URL</span> <span class="token operator">=</span> <span class="token string">"/admin/product/baseTrademark/"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">// 获取已有品牌的接口方法</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment">// 需要携带两个参数：</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">//page: 获取第几页的数据，默认第一页</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">//limit: 获取几个已有品牌的数据</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">reqHasTrademark</span> <span class="token operator">=</span> <span class="token punctuation">(</span>page<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> limit<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=></span> request<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">get</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> TrademarkResponseData<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token constant">API</span><span class="token punctuation">.</span><span class="token constant">TRADEMARK_URL</span> <span class="token operator">+</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>page<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>limit<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><ul><li>组件内部也要补一下 ts 类型 (views/product/trademark/index.vue):</li></ul><pre><code class="language-vue">&lt;script&gt;
import type &#123; Records, TrademarkResponseData &#125; from &quot;@/api/product/trademark/type&quot;;

let trademarkArr = ref &lt; Records &gt; [];
// ………………
let result: TrademarkResponseData = await reqHasTrademark(pageNo.value, limit.value);
&lt;/script&gt;
</code></pre><h4 id="3-分页展示数据"><a class="anchor" href="#3-分页展示数据">#</a> 3. 分页展示数据</h4><pre><code class="language-vue">&lt;template&gt;
  &lt;!-- 分页器组件 --&gt;
  &lt;el-pagination @current-change=&quot;changePageNo&quot; @size-change=&quot;sizeChange&quot; v-model:current-page=&quot;pageNo&quot; v-model:page-size=&quot;limit&quot; :page-sizes=&quot;[3, 5, 7, 9]&quot; :background=&quot;true&quot; layout=&quot; prev, pager, next, jumper, -&gt;,sizes,total&quot; :total=&quot;total&quot; /&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
//分页器当前页码发生变化的时候触发
const changePageNo = () =&gt; &#123;
  //不用传参，因为组件内置的v-model已经传入，双向绑定
  getHsaTrademark();
&#125;;
//下拉菜单发生变化的时候触发
const sizeChange = () =&gt; &#123;
  //当前每页的数据量发生变化时，当前页码归1
  pageNo.value = 1;
  getHsaTrademark();
&#125;;
&lt;/script&gt;
</code></pre><h4 id="4-对话框-dailog-对话框静态搭建-添加与修改品牌业务实现"><a class="anchor" href="#4-对话框-dailog-对话框静态搭建-添加与修改品牌业务实现">#</a> 4. 对话框 dailog 对话框静态搭建 （添加与修改品牌业务实现）</h4><blockquote><p>elementplus 组件之 dailog 对话框：在保留当前页面状态的情况下，告知用户并承载相关操作</p></blockquote><ol><li>写相应静态</li></ol><pre><code class="language-vue">&lt;template&gt;
  &lt;!-- 对话框组件：在添加品牌与修改已有业务时候使用 --&gt;
  &lt;!-- v-model属性控制对话框的显示与隐藏（true：显示，false：隐藏） --&gt;
  &lt;!-- title：设置对话框左上角标题 --&gt;
  &lt;el-dialog v-model=&quot;dialogFormVisible&quot; title=&quot;添加品牌&quot;&gt;
    &lt;el-form style=&quot;width: 80%&quot;&gt;
      &lt;el-form-item label=&quot;品牌名称&quot; label-width=&quot;80px&quot;&gt;
        &lt;el-input placeholder=&quot;请输入品牌名称&quot;&gt;&lt;/el-input&gt;
      &lt;/el-form-item&gt;
      &lt;el-form-item label=&quot;品牌logo&quot; label-width=&quot;80px&quot;&gt;
        &lt;el-upload class=&quot;avatar-uploader&quot; action=&quot;https://run.mocky.io/v3/9d059bf9-4660-45f2-925d-ce80ad6c4d15&quot; :show-file-list=&quot;false&quot; :on-success=&quot;handleAvatarSuccess&quot; :before-upload=&quot;beforeAvatarUpload&quot;&gt;
          &lt;img v-if=&quot;imageUrl&quot; :src=&quot;imageUrl&quot; class=&quot;avatar&quot; /&gt;
          &lt;el-icon v-else class=&quot;avatar-uploader-icon&quot;&gt;&lt;Plus /&gt;&lt;/el-icon&gt;
        &lt;/el-upload&gt;
      &lt;/el-form-item&gt;
    &lt;/el-form&gt;
    &lt;!-- 具名插槽：footer --&gt;
    &lt;template #footer&gt;
      &lt;el-button type=&quot;primary&quot; size=&quot;default&quot; @click=&quot;cancel&quot;&gt;取消&lt;/el-button&gt;
      &lt;el-button type=&quot;primary&quot; size=&quot;default&quot; @click=&quot;confirm&quot;&gt;确定&lt;/el-button&gt;
    &lt;/template&gt;
  &lt;/el-dialog&gt;
&lt;/template&gt;

&lt;script&gt;
//控制对话框的显示与隐藏
let dialogFormVisible = ref &lt; boolean &gt; false;

//&quot;添加品牌&quot;按钮的回调
const addTrademark = () =&gt; &#123;
  //点击对话框显示
  dialogFormVisible.value = true;
&#125;;
//&quot;修改品牌&quot;按钮的回调
const updateTrademark = () =&gt; &#123;
  //点击对话框显示
  dialogFormVisible.value = true;
&#125;;

//对话框底部取消按钮
const cancel = () =&gt; &#123;
  //对话框隐藏
  dialogFormVisible.value = false;
&#125;;
//对话框底部确定按钮
const confirm = () =&gt; &#123;
  dialogFormVisible.value = false;
&#125;;
&lt;/script&gt;
</code></pre><ol start="2"><li>收集新增品牌数据</li></ol><ul><li>2.1 写接口<blockquote><p>新增品牌的接口不需要带 id，修改已存在的品牌的接口则需要传入 id. 二者的区别就是需不需要带 id<br>api/product/trademark/index.ts:</p></blockquote></li></ul><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 书写品牌管理模块的接口</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> request <span class="token keyword">from</span> <span class="token string">"@/utils/request"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">&#123;</span> TrademarkResponseData<span class="token punctuation">,</span> Trademark <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"./type"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">// 品牌管理模块接口地址</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">enum</span> <span class="token constant">API</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token comment">// 获取已有品牌接口</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token constant">TRADEMARK_URL</span> <span class="token operator">=</span> <span class="token string">"/admin/product/baseTrademark/"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token comment">// 添加品牌的接口地址 POST 请求</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token constant">ADDTRADENARJ_URL</span> <span class="token operator">=</span> <span class="token string">"/admin/product/baseTrademark/save"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token comment">// 修改已有品牌的数据 PUT 请求</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token constant">UPDATETRADEMARK_URL</span> <span class="token operator">=</span> <span class="token string">"/admin/product/baseTrademark/update"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment">// 获取已有品牌的接口方法</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">// 需要携带两个参数：</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment">//page: 获取第几页的数据，默认第一页</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment">//limit: 获取几个已有品牌的数据</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">reqHasTrademark</span> <span class="token operator">=</span> <span class="token punctuation">(</span>page<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> limit<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=></span> request<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">get</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> TrademarkResponseData<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token constant">API</span><span class="token punctuation">.</span><span class="token constant">TRADEMARK_URL</span> <span class="token operator">+</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>page<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>limit<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token comment">// 添加与修改已有品牌的接口方法</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">reqAddOrUpdateTrademark</span> <span class="token operator">=</span> <span class="token punctuation">(</span>data<span class="token operator">:</span> Trademark<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>  <span class="token comment">// 判断参数带不带 id，如果有 id 就是修改已有品牌的数据，</span></pre></td></tr><tr><td data-num="22"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token keyword">return</span> request<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">put</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token constant">API</span><span class="token punctuation">.</span><span class="token constant">UPDATETRADEMARK_URL</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token comment">// 如果没有 id 就是添加品牌；</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">return</span> request<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">post</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token constant">API</span><span class="token punctuation">.</span><span class="token constant">ADDTRADENARJ_URL</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure><ul><li>2.2 组件发请求</li></ul><pre><code class="language-vue">&lt;template&gt;
  &lt;el-form style=&quot;width: 80%&quot;&gt;
    &lt;el-form-item label=&quot;品牌名称&quot; label-width=&quot;80px&quot;&gt;
      &lt;el-input placeholder=&quot;请输入品牌名称&quot; v-model=&quot;trademarkParams.tmName&quot;&gt;&lt;/el-input&gt;
    &lt;/el-form-item&gt;
    &lt;el-form-item label=&quot;品牌logo&quot; label-width=&quot;80px&quot;&gt;
      &lt;!-- 上传图片是要上传到服务器中，所以是要发请求 action传入后端写的上传文件的接口地址 --&gt;
      &lt;el-upload class=&quot;avatar-uploader&quot; action=&quot;/api/admin/product/fileUpload&quot; :show-file-list=&quot;false&quot; :on-success=&quot;handleAvatarSuccess&quot; :before-upload=&quot;beforeAvatarUpload&quot;&gt;
        &lt;img v-if=&quot;trademarkParams.logoUrl&quot; :src=&quot;trademarkParams.logoUrl&quot; class=&quot;avatar&quot; /&gt;
        &lt;el-icon v-else class=&quot;avatar-uploader-icon&quot;&gt;&lt;Plus /&gt;&lt;/el-icon&gt;
      &lt;/el-upload&gt;
    &lt;/el-form-item&gt;
  &lt;/el-form&gt;
&lt;/template&gt;

&lt;script&gt;
import &#123; ref, reactive, onMounted &#125; from &quot;vue&quot;;
import type &#123; Records, TrademarkResponseData, Trademark &#125; from &quot;@/api/product/trademark/type&quot;;
import type &#123; UploadProps &#125; from &quot;element-plus&quot;;
import &#123; ElMessage &#125; from &quot;element-plus&quot;;
//定义收集新增品牌数据
//这里用reactive是因为对象内的数据也需要响应式，每个数据在表单中都会变化
let trademarkParams =
  reactive &lt;
  Trademark &gt;
  &#123;
    tmName: &quot;&quot;,
    logoUrl: &quot;&quot;,
  &#125;;

//上传图片之前触发的钩子函数:作用是可以用来约束上传文件的类型、大小
const beforeAvatarUpload: UploadProps[&quot;beforeUpload&quot;] = (rawFile) =&gt; &#123;
  if (rawFile.type !== &quot;image/jpeg&quot;) &#123;
    ElMessage.error(&quot;上传的图片必须是jpg格式!&quot;);
    return false;
  &#125; else if (rawFile.size / 1024 / 1024 &gt; 4) &#123;
    ElMessage.error(&quot;上传的图片不能超过4MB!&quot;);
    return false;
  &#125;
  return true;
&#125;;

//文件上传成功时触发的钩子
const handleAvatarSuccess: UploadProps[&quot;onSuccess&quot;] = (response, uploadFile) =&gt; &#123;
  //response:即为当前这次上传图片post请求服务器返回的数据
  //存储收集上传的图片的地址，添加一个新的品牌的时候上传给服务器
  trademarkParams.logoUrl = response.data;
&#125;;
&lt;/script&gt;
</code></pre><ol start="3"><li>完成添加新的品牌的业务<blockquote><p>新增后还需要发请求重新获取一遍所有商品</p></blockquote></li></ol><pre><code class="language-vue">&lt;script&gt;
import &#123; reqHasTrademark, reqAddOrUpdateTrademark &#125; from &quot;@/api/product/trademark&quot;;

//&quot;添加品牌&quot;按钮的回调
const addTrademark = () =&gt; &#123;
  //先清空收集的数据
  trademarkParams.tmName = &quot;&quot;;
  trademarkParams.logoUrl = &quot;&quot;;
  //点击对话框显示
  dialogFormVisible.value = true;
&#125;;

//对话框底部确定按钮
const confirm = async () =&gt; &#123;
  let result: any = await reqAddOrUpdateTrademark(trademarkParams);
  if (result.code == 200) &#123;
    //弹出添加成功的信息；对话框关闭；重新发一次请求获取全部数据；清空trademarkParams数据（这个在“添加品牌”的按钮业务中做，每一次添加品牌前都清空数据）
    dialogFormVisible.value = false;
    ElMessage(&#123;
      type: &quot;success&quot;,
      message: &quot;添加品牌成功&quot;,
    &#125;);
    getHsaTrademark();
  &#125; else &#123;
    dialogFormVisible.value = false;
    ElMessage(&#123;
      type: &quot;error&quot;,
      message: &quot;添加品牌失败&quot;,
    &#125;);
  &#125;
&#125;;
&lt;/script&gt;
</code></pre><ol start="4"><li>完成修改已有品牌的业务</li></ol><pre><code class="language-vue">&lt;template&gt;
  &lt;el-table-column label=&quot;品牌操作&quot;&gt;
    &lt;template #=&quot;&#123; row, $index &#125;&quot;&gt;
      &lt;el-button type=&quot;primary&quot; size=&quot;small&quot; icon=&quot;Edit&quot; @click=&quot;updateTrademark(row)&quot;&gt;&lt;/el-button&gt;
    &lt;/template&gt;
  &lt;/el-table-column&gt;

  &lt;el-dialog v-model=&quot;dialogFormVisible&quot; :title=&quot;trademarkParams.id ? '修改品牌' : '添加品牌'&quot;&gt;&lt;/el-dialog&gt;
&lt;/template&gt;

&lt;script&gt;
//&quot;修改品牌&quot;按钮的回调
//参数row：即为当前已有的品牌
const updateTrademark = (row: Trademark) =&gt; &#123;
  //点击对话框显示
  dialogFormVisible.value = true;
  Object.assign(trademarkParams, row);
&#125;;
&lt;/script&gt;
</code></pre><ol start="5"><li>品牌管理模块 dialog 表单校验<br>利用 el-form 组件提供的表单校验功能<br>views/product/trademark/index.vue</li></ol><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 对话框底部确定按钮</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">const</span> <span class="token function-variable function">confirm</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token comment">// 在发请求之前，对整个表单进行校验</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token comment">// 调用这个方法进行全部的表单项校验，使用 await 保证只有校验全部通过才能执行后面的内容</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token keyword">await</span> formRef<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">validator</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  ……………………</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><ol start="6"><li>品牌管理模块删除业务</li></ol><pre><code class="language-vue">&lt;template&gt;
  &lt;el-popconfirm :title=&quot;`确定删除$&#123;row.tmName&#125;?`&quot; width=&quot;250px&quot; icon=&quot;Delete&quot;&gt;
    &lt;template #reference&gt;
      &lt;el-button type=&quot;primary&quot; size=&quot;small&quot; icon=&quot;Delete&quot; @confirm=&quot;removeTrademark(row.id)&quot;&gt;&lt;/el-button&gt;
    &lt;/template&gt;
  &lt;/el-popconfirm&gt;
&lt;/template&gt;

&lt;script&gt;&lt;/script&gt;
</code></pre><h3 id="218-平台属性管理"><a class="anchor" href="#218-平台属性管理">#</a> 2.18 平台属性管理</h3><h4 id="1-平台属性管理模块静态搭建"><a class="anchor" href="#1-平台属性管理模块静态搭建">#</a> 1. 平台属性管理模块静态搭建</h4><blockquote><p>（三级联动：一级不需要传参，二级需要带着一级分类的 id，三级需要带着二级分类的 id。等三级分类也确定后再发一次请求，获取属性数据）</p></blockquote><ol><li>因为三级联动组件在 spu 也会用到，所以将其变为全局组件 Category</li></ol><ul><li>components/Category/index.vue</li></ul><pre><code class="language-vue">&lt;template&gt;
  &lt;!-- 三级联动 --&gt;
  &lt;el-card&gt;
    &lt;el-form :inline=&quot;true&quot;&gt;
      &lt;el-form-item label=&quot;一级分类&quot;&gt;
        &lt;el-select&gt;
          &lt;el-option label=&quot;北京&quot;&gt;&lt;/el-option&gt;
        &lt;/el-select&gt;
      &lt;/el-form-item&gt;
      &lt;el-form-item label=&quot;二级分类&quot;&gt;
        &lt;el-select&gt;
          &lt;el-option label=&quot;北京&quot;&gt;&lt;/el-option&gt;
        &lt;/el-select&gt;
      &lt;/el-form-item&gt;
      &lt;el-form-item label=&quot;三级分类&quot;&gt;
        &lt;el-select&gt;
          &lt;el-option label=&quot;北京&quot;&gt;&lt;/el-option&gt;
        &lt;/el-select&gt;
      &lt;/el-form-item&gt;
    &lt;/el-form&gt;
  &lt;/el-card&gt;
&lt;/template&gt;
</code></pre><ul><li>components/index.ts</li></ul><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 引入项目中的全局组件</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> SvgIcon <span class="token keyword">from</span> <span class="token string">"@/components/SvgIcon/index.vue"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> Category <span class="token keyword">from</span> <span class="token string">"@/components/Category/index.vue"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">&#123;</span> App<span class="token punctuation">,</span> Component <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"vue"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 引入 element-plus 提供的全部图标组件</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> ElementPlusIconsVue <span class="token keyword">from</span> <span class="token string">"@element-plus/icons-vue"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">// 全局对象</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">const</span> components<span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">[</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> Component <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> SvgIcon<span class="token punctuation">,</span> Category <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">// 对外暴露插件对象</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token function">install</span><span class="token punctuation">(</span>app<span class="token operator">:</span> App<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>components<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>      app<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> components<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token comment">// 将 element-plus 提供图标注册为全局组件</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span> component<span class="token punctuation">]</span> <span class="token keyword">of</span> Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>ElementPlusIconsVue<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>      app<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> component<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>其他的可以写在 views/product/attr/index.vue</p><pre><code class="language-vue">&lt;template&gt;
  &lt;!-- 三级联动组件 --&gt;
  &lt;Category /&gt;
  &lt;!-- 平台属性 --&gt;
  &lt;el-card style=&quot;margin: 10px 0&quot;&gt;
    &lt;el-button type=&quot;primary&quot; icon=&quot;Plus&quot;&gt;添加属性&lt;/el-button&gt;
    &lt;el-table border stripe&gt;
      &lt;el-table-column label=&quot;序号&quot; type=&quot;index&quot; align=&quot;center&quot; width=&quot;80px&quot;&gt;&lt;/el-table-column&gt;
      &lt;el-table-column label=&quot;属性名称&quot; width=&quot;120px&quot;&gt;&lt;/el-table-column&gt;
      &lt;el-table-column label=&quot;属性值名称&quot;&gt;&lt;/el-table-column&gt;
      &lt;el-table-column label=&quot;操作&quot; width=&quot;120px&quot;&gt;&lt;/el-table-column&gt;
    &lt;/el-table&gt;
  &lt;/el-card&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;&lt;/script&gt;

&lt;style scoped lang=&quot;less&quot;&gt;&lt;/style&gt;
</code></pre><h4 id="2-属性管理模块一级分类数据收集与展示"><a class="anchor" href="#2-属性管理模块一级分类数据收集与展示">#</a> 2. 属性管理模块一级分类数据收集与展示</h4><ol><li>写接口 api/product/attr/index.ts:</li></ol><pre><code class="language-ts">
</code></pre><ol start="2"><li>展示数据 components/Category/index.vue：<br>// 因为将来别的组件也需要用的三级联动的数据，需要组件通信，所以不应该把数据存储在子组件中，应该存储在 pinia 仓库中</li></ol><pre><code class="language-vue">
</code></pre><h3 id="219-spu-模块"><a class="anchor" href="#219-spu-模块">#</a> 2.19 SPU 模块</h3><h3 id="特喵的这样效率太慢了跳了跳了"><a class="anchor" href="#特喵的这样效率太慢了跳了跳了">#</a> 特喵的这样效率太慢了，跳了跳了</h3><h3 id="权限管理-用户管理"><a class="anchor" href="#权限管理-用户管理">#</a> 权限管理 - 用户管理</h3><h4 id="1-用户管理静态搭建"><a class="anchor" href="#1-用户管理静态搭建">#</a> 1. 用户管理静态搭建</h4><p>views/acl/user/index.vue:</p><pre><code class="language-vue">&lt;template&gt;
  &lt;el-card style=&quot;height: 80px&quot;&gt;
    &lt;el-form :inline=&quot;true&quot; class=&quot;form&quot;&gt;
      &lt;el-form-item label=&quot;用户名:&quot;&gt;
        &lt;el-input placeholder=&quot;请输入搜索用户名&quot;&gt;&lt;/el-input&gt;
      &lt;/el-form-item&gt;
      &lt;el-form-item&gt;
        &lt;el-button type=&quot;primary&quot; size=&quot;default&quot;&gt;搜索&lt;/el-button&gt;
        &lt;el-button type=&quot;primary&quot; size=&quot;default&quot;&gt;重置&lt;/el-button&gt;
      &lt;/el-form-item&gt;
    &lt;/el-form&gt;
  &lt;/el-card&gt;
  &lt;el-card style=&quot;margin: 10px 0px&quot;&gt;
    &lt;el-button type=&quot;primary&quot; size=&quot;default&quot;&gt;添加用户&lt;/el-button&gt;
    &lt;el-button type=&quot;primary&quot; size=&quot;default&quot;&gt;批量删除&lt;/el-button&gt;
    &lt;!-- table展示用户信息 --&gt;
    &lt;el-table style=&quot;margin: 10px 0px&quot; border&gt;
      &lt;el-table-column type=&quot;selection&quot; align=&quot;center&quot;&gt;&lt;/el-table-column&gt;
      &lt;el-table-column label=&quot;#&quot; align=&quot;center&quot; type=&quot;index&quot;&gt;&lt;/el-table-column&gt;
      &lt;el-table-column label=&quot;ID&quot; align=&quot;center&quot;&gt;&lt;/el-table-column&gt;
      &lt;el-table-column label=&quot;用户名字&quot; align=&quot;center&quot;&gt;&lt;/el-table-column&gt;
      &lt;el-table-column label=&quot;用户名称&quot; align=&quot;center&quot;&gt;&lt;/el-table-column&gt;
      &lt;el-table-column label=&quot;用户角色&quot; align=&quot;center&quot;&gt;&lt;/el-table-column&gt;
      &lt;el-table-column label=&quot;创建时间&quot; align=&quot;center&quot;&gt;&lt;/el-table-column&gt;
      &lt;el-table-column label=&quot;更新时间&quot; align=&quot;center&quot;&gt;&lt;/el-table-column&gt;
      &lt;el-table-column label=&quot;操作&quot; width=&quot;300px&quot; align=&quot;center&quot;&gt; &lt;/el-table-column&gt;
    &lt;/el-table&gt;
    &lt;!-- 分页器 --&gt;
    &lt;el-pagination v-model:current-page=&quot;pageNo&quot; v-model:page-size=&quot;pageSize&quot; :page-sizes=&quot;[5, 7, 9, 11]&quot; :background=&quot;true&quot; layout=&quot;prev, pager, next, jumper,-&gt;,sizes,total&quot; :total=&quot;400&quot; /&gt;
  &lt;/el-card&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import &#123; ref &#125; from &quot;vue&quot;;
let pageNo = ref&lt;number&gt;(1);

let pageSize = ref&lt;number&gt;(5);
&lt;/script&gt;

&lt;style scoped lang=&quot;scss&quot;&gt;
.form &#123;
  display: flex;
  justify-content: space-between;
  align-items: center;
&#125;
&lt;/style&gt;
</code></pre><h4 id="2-用户管理展示已有账号数据"><a class="anchor" href="#2-用户管理展示已有账号数据">#</a> 2. 用户管理展示已有账号数据</h4><ol><li>定义接口 api/acl/user/index.ts:</li></ol><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 用户管理模块的接口</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> request <span class="token keyword">from</span> <span class="token string">"@/utils/request"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">&#123;</span> UserResponseData <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"./type"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">enum</span> <span class="token constant">API</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token comment">// 获取全部已有用户的账号信息</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token constant">ALLUSER_URL</span> <span class="token operator">=</span> <span class="token string">"/admin/acl/user/"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment">// 获取用户账号信息的接口方法</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">reqUserInfo</span> <span class="token operator">=</span> <span class="token punctuation">(</span>page<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> limit<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=></span> request<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">get</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> UserResponseData<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token constant">API</span><span class="token punctuation">.</span><span class="token constant">ALLUSER_URL</span> <span class="token operator">+</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>page<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>limit<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><ol start="2"><li>定义接口类型 api/acl/user/type.ts:</li></ol><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 账号信息的 ts 类型</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">ResponseData</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  code<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  message<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  ok<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">// 代表一个账号信息的 ts 类型</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">User</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  id<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  createTime<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  updateTime<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  username<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  password<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  name<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  phone<span class="token operator">?</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>  roleName<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment">// 数组包含全部的用户信息</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">Records</span> <span class="token operator">=</span> User<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token comment">// 获取全部用户信息接口返回的数据 ts 类型</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">UserResponseData</span> <span class="token keyword">extends</span> <span class="token class-name">ResponseData</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>  data<span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    records<span class="token operator">:</span> Records<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    total<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    size<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    current<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    pages<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="30"></td><td><pre></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token comment">// 代表一个职位的 ts 类型</span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">RoleData</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>  id<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>  createTime<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>  updateTime<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>  roleName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>  remark<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token comment">// 全部职位的列表</span></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">AllRole</span> <span class="token operator">=</span> RoleData<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token comment">// 获取全部职位的接口返回的数据 ts 类型</span></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">AllRoleResponseData</span> <span class="token keyword">extends</span> <span class="token class-name">ResponseData</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>  data<span class="token operator">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>    assignRoles<span class="token operator">:</span> AllRole<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>    allRolesList<span class="token operator">:</span> AllRole<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="48"></td><td><pre></pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token comment">// 给用户分配职位接口携带参数的 ts 类型</span></pre></td></tr><tr><td data-num="50"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">SetRoleData</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>  roleIdList<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>  userId<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="53"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><ol start="3"><li>获取用户数据并展示以及分页器功能 views/acl/user/index.vue:</li></ol><pre><code class="language-vue">&lt;template&gt;
  &lt;el-card style=&quot;height: 80px&quot;&gt;
    &lt;el-form :inline=&quot;true&quot; class=&quot;form&quot;&gt;
      &lt;el-form-item label=&quot;用户名:&quot;&gt;
        &lt;el-input placeholder=&quot;请输入搜索用户名&quot;&gt;&lt;/el-input&gt;
      &lt;/el-form-item&gt;
      &lt;el-form-item&gt;
        &lt;el-button type=&quot;primary&quot; size=&quot;default&quot;&gt;搜索&lt;/el-button&gt;
        &lt;el-button type=&quot;primary&quot; size=&quot;default&quot;&gt;重置&lt;/el-button&gt;
      &lt;/el-form-item&gt;
    &lt;/el-form&gt;
  &lt;/el-card&gt;
  &lt;el-card style=&quot;margin: 10px 0px&quot;&gt;
    &lt;el-button type=&quot;primary&quot; size=&quot;default&quot;&gt;添加用户&lt;/el-button&gt;
    &lt;el-button type=&quot;primary&quot; size=&quot;default&quot;&gt;批量删除&lt;/el-button&gt;
    &lt;!-- table展示用户信息 --&gt;
    &lt;el-table style=&quot;margin: 10px 0px&quot; border :data=&quot;userArr&quot;&gt;
      &lt;el-table-column type=&quot;selection&quot; align=&quot;center&quot;&gt;&lt;/el-table-column&gt;
      &lt;el-table-column label=&quot;#&quot; align=&quot;center&quot; type=&quot;index&quot;&gt;&lt;/el-table-column&gt;
      &lt;el-table-column label=&quot;ID&quot; align=&quot;center&quot; prop=&quot;id&quot;&gt;&lt;/el-table-column&gt;
      &lt;el-table-column label=&quot;用户名字&quot; align=&quot;center&quot; prop=&quot;username&quot;&gt;&lt;/el-table-column&gt;
      &lt;el-table-column label=&quot;用户名称&quot; align=&quot;center&quot; prop=&quot;name&quot;&gt;&lt;/el-table-column&gt;
      &lt;el-table-column label=&quot;用户角色&quot; align=&quot;center&quot; prop=&quot;roleName&quot;&gt;&lt;/el-table-column&gt;
      &lt;el-table-column label=&quot;创建时间&quot; align=&quot;center&quot; prop=&quot;createtTime&quot;&gt;&lt;/el-table-column&gt;
      &lt;el-table-column label=&quot;更新时间&quot; align=&quot;center&quot; prop=&quot;updateTime&quot;&gt;&lt;/el-table-column&gt;
      &lt;el-table-column label=&quot;操作&quot; width=&quot;300px&quot; align=&quot;center&quot;&gt;
        &lt;template #=&quot;&#123; row, $index &#125;&quot;&gt;
          &lt;el-button type=&quot;primary&quot; size=&quot;small&quot; icon=&quot;User&quot;&gt;分配角色&lt;/el-button&gt;
          &lt;el-button type=&quot;primary&quot; size=&quot;small&quot; icon=&quot;Edit&quot;&gt;编辑&lt;/el-button&gt;
          &lt;el-button type=&quot;primary&quot; size=&quot;small&quot; icon=&quot;Delete&quot;&gt;删除&lt;/el-button&gt;
        &lt;/template&gt;
      &lt;/el-table-column&gt;
    &lt;/el-table&gt;
    &lt;!-- 分页器 --&gt;
    &lt;el-pagination v-model:current-page=&quot;pageNo&quot; v-model:page-size=&quot;pageSize&quot; :page-sizes=&quot;[5, 7, 9, 11]&quot; :background=&quot;true&quot; layout=&quot;prev, pager, next, jumper,-&gt;,sizes,total&quot; :total=&quot;total&quot; @current-change=&quot;getHasUser&quot; @size-change=&quot;handler&quot; /&gt;
  &lt;/el-card&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import &#123; ref, onMounted &#125; from &quot;vue&quot;;
import &#123; reqUserInfo &#125; from &quot;@/api/acl/user&quot;;
import type &#123; UserResponseData, Records &#125; from &quot;@/api/acl/user/type&quot;;
//默认页码
let pageNo = ref&lt;number&gt;(1);
//一页展示几条数据
let pageSize = ref&lt;number&gt;(5);
//用户总数
let total = ref&lt;number&gt;(0);
//存储全部用户的数据
let userArr = ref&lt;Records&gt;([]);

onMounted(() =&gt; &#123;
  getHasUser();
&#125;);

//获取全部已有的用户信息的方法封装
const getHasUser = async (pager = 1) =&gt; &#123;
  pageNo.value = pager;
  let result: UserResponseData = await reqUserInfo(pageNo.value, pageSize.value);
  if (result.code == 200) &#123;
    total.value = result.data.total;
    userArr.value = result.data.records;
  &#125;
&#125;;

//分页器下拉菜单自定义事件的回调
const handler = () =&gt; &#123;
  getHasUser();
&#125;;
&lt;/script&gt;

&lt;style scoped lang=&quot;scss&quot;&gt;
.form &#123;
  display: flex;
  justify-content: space-between;
  align-items: center;
&#125;
&lt;/style&gt;
</code></pre><h4 id="3-添加与编辑修改用户业务实现"><a class="anchor" href="#3-添加与编辑修改用户业务实现">#</a> 3. “添加” 与 “编辑”（修改）用户业务实现</h4><p>// 点击 “添加” 按钮后从右侧弹出抽屉。“添加” 和 “编辑” 都用这个，区别它们就看是否携带 id</p><ol><li>静态搭建</li></ol><pre><code class="language-vue">&lt;template&gt;
  &lt;el-card style=&quot;height: 80px&quot;&gt;
    &lt;el-form :inline=&quot;true&quot; class=&quot;form&quot;&gt;
      &lt;el-form-item label=&quot;用户名:&quot;&gt;
        &lt;el-input placeholder=&quot;请输入搜索用户名&quot;&gt;&lt;/el-input&gt;
      &lt;/el-form-item&gt;
      &lt;el-form-item&gt;
        &lt;el-button type=&quot;primary&quot; size=&quot;default&quot;&gt;搜索&lt;/el-button&gt;
        &lt;el-button type=&quot;primary&quot; size=&quot;default&quot;&gt;重置&lt;/el-button&gt;
      &lt;/el-form-item&gt;
    &lt;/el-form&gt;
  &lt;/el-card&gt;
  &lt;el-card style=&quot;margin: 10px 0px&quot;&gt;
    &lt;el-button type=&quot;primary&quot; size=&quot;default&quot; @click=&quot;addUser&quot;&gt;添加用户&lt;/el-button&gt;
    &lt;el-button type=&quot;primary&quot; size=&quot;default&quot;&gt;批量删除&lt;/el-button&gt;
    &lt;!-- table展示用户信息 --&gt;
    &lt;el-table style=&quot;margin: 10px 0px&quot; border :data=&quot;userArr&quot;&gt;
      &lt;el-table-column type=&quot;selection&quot; align=&quot;center&quot;&gt;&lt;/el-table-column&gt;
      &lt;el-table-column label=&quot;#&quot; align=&quot;center&quot; type=&quot;index&quot;&gt;&lt;/el-table-column&gt;
      &lt;el-table-column label=&quot;ID&quot; align=&quot;center&quot; prop=&quot;id&quot;&gt;&lt;/el-table-column&gt;
      &lt;el-table-column label=&quot;用户名字&quot; align=&quot;center&quot; prop=&quot;username&quot;&gt;&lt;/el-table-column&gt;
      &lt;el-table-column label=&quot;用户名称&quot; align=&quot;center&quot; prop=&quot;name&quot;&gt;&lt;/el-table-column&gt;
      &lt;el-table-column label=&quot;用户角色&quot; align=&quot;center&quot; prop=&quot;roleName&quot;&gt;&lt;/el-table-column&gt;
      &lt;el-table-column label=&quot;创建时间&quot; align=&quot;center&quot; prop=&quot;createtTime&quot;&gt;&lt;/el-table-column&gt;
      &lt;el-table-column label=&quot;更新时间&quot; align=&quot;center&quot; prop=&quot;updateTime&quot;&gt;&lt;/el-table-column&gt;
      &lt;el-table-column label=&quot;操作&quot; width=&quot;300px&quot; align=&quot;center&quot;&gt;
        &lt;template #=&quot;&#123; row, $index &#125;&quot;&gt;
          &lt;el-button type=&quot;primary&quot; size=&quot;small&quot; icon=&quot;User&quot;&gt;分配角色&lt;/el-button&gt;
          &lt;el-button type=&quot;primary&quot; size=&quot;small&quot; icon=&quot;Edit&quot; @click=&quot;updateUser(row)&quot;&gt;编辑&lt;/el-button&gt;
          &lt;el-button type=&quot;primary&quot; size=&quot;small&quot; icon=&quot;Delete&quot;&gt;删除&lt;/el-button&gt;
        &lt;/template&gt;
      &lt;/el-table-column&gt;
    &lt;/el-table&gt;
    &lt;!-- 分页器 --&gt;
    &lt;el-pagination v-model:current-page=&quot;pageNo&quot; v-model:page-size=&quot;pageSize&quot; :page-sizes=&quot;[5, 7, 9, 11]&quot; :background=&quot;true&quot; layout=&quot;prev, pager, next, jumper,-&gt;,sizes,total&quot; :total=&quot;total&quot; @current-change=&quot;getHasUser&quot; @size-change=&quot;handler&quot; /&gt;
  &lt;/el-card&gt;
  &lt;!-- 抽屉结构:完成添加新的用户账号|更新已有的账号信息 --&gt;
  &lt;!-- 通过`v-model=&quot;drawer&quot;`控制抽屉组件显示与隐藏 --&gt;
  &lt;el-drawer v-model=&quot;drawer&quot;&gt;
    &lt;!-- 头部标题:将来文字内容应该动态的 --&gt;
    &lt;template #header&gt;
      &lt;h4&gt;添加用户&lt;/h4&gt;
    &lt;/template&gt;
    &lt;!-- 身体部分 --&gt;
    &lt;template #default&gt;
      &lt;el-form ref=&quot;formRef&quot;&gt;
        &lt;el-form-item label=&quot;用户姓名&quot; prop=&quot;username&quot;&gt;
          &lt;el-input placeholder=&quot;请输入用户姓名&quot;&gt;&lt;/el-input&gt;
        &lt;/el-form-item&gt;
        &lt;el-form-item label=&quot;用户昵称&quot; prop=&quot;name&quot;&gt;
          &lt;el-input placeholder=&quot;请输入用户昵称&quot;&gt;&lt;/el-input&gt;
        &lt;/el-form-item&gt;
        &lt;el-form-item label=&quot;用户密码&quot; prop=&quot;password&quot;&gt;
          &lt;el-input placeholder=&quot;请输入用户密码&quot;&gt;&lt;/el-input&gt;
        &lt;/el-form-item&gt;
      &lt;/el-form&gt;
    &lt;/template&gt;
    &lt;template #footer&gt;
      &lt;div style=&quot;flex: auto&quot;&gt;
        &lt;el-button&gt;取消&lt;/el-button&gt;
        &lt;el-button type=&quot;primary&quot;&gt;确定&lt;/el-button&gt;
      &lt;/div&gt;
    &lt;/template&gt;
  &lt;/el-drawer&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import &#123; ref, onMounted &#125; from &quot;vue&quot;;
import &#123; reqUserInfo &#125; from &quot;@/api/acl/user&quot;;
import type &#123; UserResponseData, Records, User &#125; from &quot;@/api/acl/user/type&quot;;
//默认页码
let pageNo = ref&lt;number&gt;(1);
//一页展示几条数据
let pageSize = ref&lt;number&gt;(5);
//用户总数
let total = ref&lt;number&gt;(0);
//存储全部用户的数据
let userArr = ref&lt;Records&gt;([]);
//定义响应式数据控制抽屉的显示与隐藏
let drawer = ref&lt;boolean&gt;(false);

onMounted(() =&gt; &#123;
  getHasUser();
&#125;);

//获取全部已有的用户信息的方法封装
const getHasUser = async (pager = 1) =&gt; &#123;
  pageNo.value = pager;
  let result: UserResponseData = await reqUserInfo(pageNo.value, pageSize.value);
  if (result.code == 200) &#123;
    total.value = result.data.total;
    userArr.value = result.data.records;
  &#125;
&#125;;

//分页器下拉菜单自定义事件的回调
const handler = () =&gt; &#123;
  getHasUser();
&#125;;

//“添加用户”按钮的回调
const addUser = () =&gt; &#123;
  drawer.value = true;
&#125;;
//“编辑”按钮的回调
//row：已有的用户的账号信息
const updateUser = (row: User) =&gt; &#123;
  drawer.value = true;
&#125;;
&lt;/script&gt;

&lt;style scoped lang=&quot;scss&quot;&gt;
.form &#123;
  display: flex;
  justify-content: space-between;
  align-items: center;
&#125;
&lt;/style&gt;
</code></pre><ol start="2"><li>“添加用户” 业务实现<br>需要将收集到的数据通过接口传给后端</li></ol><ul><li>2.1 写接口 api/acl/user/index.ts</li></ul><figure class="highlight ts"><figcaption data-lang="TypeScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 用户管理模块的接口</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> request <span class="token keyword">from</span> <span class="token string">"@/utils/request"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">&#123;</span> UserResponseData<span class="token punctuation">,</span> User <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">"./type"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">// 枚举地址</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">enum</span> <span class="token constant">API</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token comment">// 获取全部已有用户账号信息</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token constant">ALLUSER_URL</span> <span class="token operator">=</span> <span class="token string">"/admin/acl/user/"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token comment">// 添加一个新的用户账号</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token constant">ADDUSER_URL</span> <span class="token operator">=</span> <span class="token string">"/admin/acl/user/save"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token comment">// 更新已有的用户账号</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token constant">UPDATEUSER_URL</span> <span class="token operator">=</span> <span class="token string">"/admin/acl/user/update"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment">// 获取用户账号信息的接口</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">reqUserInfo</span> <span class="token operator">=</span> <span class="token punctuation">(</span>page<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> limit<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=></span> request<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">get</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> UserResponseData<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token constant">API</span><span class="token punctuation">.</span><span class="token constant">ALLUSER_URL</span> <span class="token operator">+</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>page<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>limit<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment">// 添加用户与更新已有用户的接口</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">reqAddOrUpdateUser</span> <span class="token operator">=</span> <span class="token punctuation">(</span>data<span class="token operator">:</span> User<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>  <span class="token comment">// 携带参数有 ID 更新</span></pre></td></tr><tr><td data-num="18"></td><td><pre>  <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token comment">// 更新</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">return</span> request<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">put</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token constant">API</span><span class="token punctuation">.</span><span class="token constant">UPDATEUSER_URL</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token comment">// 添加</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token keyword">return</span> request<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">post</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token constant">API</span><span class="token punctuation">.</span><span class="token constant">ADDUSER_URL</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure><ul><li>2.2 收集表单数据相关业务</li></ul><pre><code class="language-vue">&lt;template&gt;
  &lt;el-drawer v-model=&quot;drawer&quot;&gt;
    &lt;!-- 头部标题:将来文字内容应该动态的 --&gt;
    &lt;template #header&gt;
      &lt;h4&gt;&#123;&#123; userParams.id ? "更新用户" : "添加用户" &#125;&#125;&lt;/h4&gt;
    &lt;/template&gt;
    &lt;!-- 身体部分 --&gt;
    &lt;template #default&gt;
      &lt;el-form :model=&quot;userParams&quot; :rules=&quot;rules&quot; ref=&quot;formRef&quot;&gt;
        &lt;el-form-item label=&quot;用户姓名&quot; prop=&quot;username&quot;&gt;
          &lt;el-input placeholder=&quot;请输入用户姓名&quot; v-model=&quot;userParams.username&quot;&gt;&lt;/el-input&gt;
        &lt;/el-form-item&gt;
        &lt;el-form-item label=&quot;用户昵称&quot; prop=&quot;name&quot;&gt;
          &lt;el-input placeholder=&quot;请输入用户昵称&quot; v-model=&quot;userParams.name&quot;&gt;&lt;/el-input&gt;
        &lt;/el-form-item&gt;
        &lt;el-form-item label=&quot;用户密码&quot; prop=&quot;password&quot; v-if=&quot;!userParams.id&quot;&gt;
          &lt;el-input placeholder=&quot;请输入用户密码&quot; v-model=&quot;userParams.password&quot;&gt;&lt;/el-input&gt;
        &lt;/el-form-item&gt;
      &lt;/el-form&gt;
    &lt;/template&gt;
    &lt;template #footer&gt;
      &lt;div style=&quot;flex: auto&quot;&gt;
        &lt;el-button @click=&quot;cancel&quot;&gt;取消&lt;/el-button&gt;
        &lt;el-button type=&quot;primary&quot; @click=&quot;save&quot;&gt;确定&lt;/el-button&gt;
      &lt;/div&gt;
    &lt;/template&gt;
  &lt;/el-drawer&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot;&gt;
import &#123; ref, onMounted, reactive &#125; from &quot;vue&quot;;
import &#123; reqUserInfo, reqAddOrUpdateUser &#125; from &quot;@/api/acl/user&quot;;

//收集用户响应式数据
let userParams = reactive&lt;User&gt;(&#123;
  username: &quot;&quot;,
  name: &quot;&quot;,
  password: &quot;&quot;,
&#125;);

//“添加用户”按钮的回调
const addUser = () =&gt; &#123;
  drawer.value = true;
  //每次清空数据
  Object.assign(userParams, &#123;
    username: &quot;&quot;,
    name: &quot;&quot;,
    password: &quot;&quot;,
  &#125;);
&#125;;

//抽屉组件的“保存”按钮的回调
const save = async () =&gt; &#123;
  //保存按钮：添加新用户或更新已有用户
  let result: any = await reqAddOrUpdateUser(userParams);
  if (result.code == 200) &#123;
    drawer.value = false;
    ElMessage(&#123;
      type: &quot;success&quot;,
      message: userParams.id ? &quot;更新成功&quot; : &quot;添加成功&quot;,
    &#125;);
    getHasUser();
  &#125; else &#123;
    drawer.value = false;
    ElMessage(&#123;
      type: &quot;error&quot;,
      message: userParams.id ? &quot;更新失败&quot; : &quot;添加失败&quot;,
    &#125;);
  &#125;
&#125;;

//抽屉组件的“取消”按钮的回调
const cancel = () =&gt; &#123;
  drawer.value = false;
&#125;;
&lt;/script&gt;
</code></pre><ul><li>2.3 表单校验功能</li></ul><pre><code class="language-vue">&lt;template&gt;
  &lt;!-- `:model`、`:rules`、`ref`、`prop` 是用来做表单校验的,其中`ref`是为了获得form组件实例等校验通过后再发请求--&gt;
  &lt;el-form :model=&quot;userParams&quot; :rules=&quot;rules&quot; ref=&quot;formRef&quot;&gt;
    &lt;el-form-item label=&quot;用户姓名&quot; prop=&quot;username&quot;&gt;
      &lt;el-input placeholder=&quot;请输入用户姓名&quot; v-model=&quot;userParams.username&quot;&gt;&lt;/el-input&gt;
    &lt;/el-form-item&gt;
    &lt;el-form-item label=&quot;用户昵称&quot; prop=&quot;name&quot;&gt;
      &lt;el-input placeholder=&quot;请输入用户昵称&quot; v-model=&quot;userParams.name&quot;&gt;&lt;/el-input&gt;
    &lt;/el-form-item&gt;
    &lt;el-form-item label=&quot;用户密码&quot; prop=&quot;password&quot; v-if=&quot;!userParams.id&quot;&gt;
      &lt;el-input placeholder=&quot;请输入用户密码&quot; v-model=&quot;userParams.password&quot;&gt;&lt;/el-input&gt;
    &lt;/el-form-item&gt;
  &lt;/el-form&gt;
&lt;/template&gt;

&lt;script&gt;
//获取form组件实例
let formRef = ref&lt;any&gt;()

const save = async () =&gt; &#123;
  //点击保存按钮的时候务必保证表单校验全部通过再发请求
  await formRef.value.validator()
  …………………………………………
&#125;
//校验用户名字回调函数
const validatorUsername = (rule: any, value: any, callBack: any) =&gt; &#123;
  //用户名字|昵称,长度至少五位
  if (value.trim().length &gt;= 5) &#123;
    callBack();
  &#125; else &#123;
    callBack(new Error(&quot;用户名字至少五位&quot;));
  &#125;
&#125;;
//校验用户名字回调函数
const validatorname = (rule: any, value: any, callBack: any) =&gt; &#123;
  //用户名字|昵称,长度至少五位
  if (value.trim().length &gt;= 5) &#123;
    callBack();
  &#125; else &#123;
    callBack(new Error(&quot;用户昵称至少五位&quot;));
  &#125;
&#125;;
const validatorPassword = (rule: any, value: any, callBack: any) =&gt; &#123;
  //用户名字|昵称,长度至少五位
  if (value.trim().length &gt;= 6) &#123;
    callBack();
  &#125; else &#123;
    callBack(new Error(&quot;用户密码至少六位&quot;));
  &#125;
&#125;;
//表单校验
const rules = &#123;
  //用户名字
  username: [&#123; required: true, trigger: &quot;blur&quot;, validator: validatorUsername &#125;],
  //用户昵称
  name: [&#123; required: true, trigger: &quot;blur&quot;, validator: validatorname &#125;],
  //用户的密码
  password: [&#123; required: true, trigger: &quot;blur&quot;, validator: validatorPassword &#125;],
&#125;;
&lt;/script&gt;
</code></pre><ul><li>2.4 更新修改功能的业务实现</li></ul><h4 id="4-分配角色业务"><a class="anchor" href="#4-分配角色业务">#</a> 4. 分配角色业务</h4><ol><li>静态搭建</li></ol><pre><code class="language-vue">&lt;template&gt;
  &lt;!-- 抽屉结构:用户某一个已有的账号进行职位分配 --&gt;
  &lt;el-drawer v-model=&quot;drawer1&quot;&gt;
    &lt;template #header&gt;
      &lt;h4&gt;分配角色(职位)&lt;/h4&gt;
    &lt;/template&gt;
    &lt;template #default&gt;
      &lt;el-form&gt;
        &lt;el-form-item label=&quot;用户姓名&quot;&gt;
          &lt;el-input v-model=&quot;userParams.username&quot; :disabled=&quot;true&quot;&gt;&lt;/el-input&gt;
        &lt;/el-form-item&gt;
        &lt;el-form-item label=&quot;职位列表&quot;&gt;
          &lt;el-checkbox @change=&quot;handleCheckAllChange&quot; v-model=&quot;checkAll&quot; :indeterminate=&quot;isIndeterminate&quot;&gt;全选&lt;/el-checkbox&gt;
          &lt;!-- 显示职位的的复选框 --&gt;
          &lt;el-checkbox-group v-model=&quot;userRole&quot; @change=&quot;handleCheckedCitiesChange&quot;&gt;
            &lt;el-checkbox v-for=&quot;(role, index) in allRole&quot; :key=&quot;index&quot; :label=&quot;role&quot;&gt;&#123;&#123; role.roleName &#125;&#125;&lt;/el-checkbox&gt;
          &lt;/el-checkbox-group&gt;
        &lt;/el-form-item&gt;
      &lt;/el-form&gt;
    &lt;/template&gt;
    &lt;template #footer&gt;
      &lt;div style=&quot;flex: auto&quot;&gt;
        &lt;el-button @click=&quot;drawer1 = false&quot;&gt;取消&lt;/el-button&gt;
        &lt;el-button type=&quot;primary&quot; @click=&quot;confirmClick&quot;&gt;确定&lt;/el-button&gt;
      &lt;/div&gt;
    &lt;/template&gt;
  &lt;/el-drawer&gt;
&lt;/template&gt;

&lt;script&gt;&lt;/script&gt;
</code></pre><ol start="2"><li>分配角色业务</li></ol><h3 id="权限管理-角色管理"><a class="anchor" href="#权限管理-角色管理">#</a> 权限管理 - 角色管理</h3><h4 id="分配权限功能"><a class="anchor" href="#分配权限功能">#</a> 分配权限功能</h4><p>elementplus 树形控件<br>获取全部的菜单与按钮的数据也是通过接口。</p><ul><li><p>某个职位已有的菜单权限也是写在接口里的（seltct 的 true 与 false）。那么页面上如何展现勾与不勾呢？只需要过滤最末尾一级 id 的 select 即可。尾递归<br>准备一个数组，用于存储勾选的最末尾的节点 id，递归过滤时的条件是 select 且节点时最末一级</p></li><li><p>为只为分配权限 也是调用接口，传参 roleId (需要分配的那个职位的 id) 和 permissionId (分配给职位的权限的 id)。参数可以调用 element plus 树形控件组件实例上的方法获得</p><blockquote><p>参数是 query 格式的时候写 api 接口还需要加上 <code>?k=v</code> 形式</p></blockquote></li></ul><blockquote><p>element plus 组件的 ref 属性可以获取该组件的组件实例，调用组件的方法需要 <code>组件实例.方法()</code></p></blockquote><h3 id="权限管理-菜单管理"><a class="anchor" href="#权限管理-菜单管理">#</a> 权限管理 - 菜单管理</h3><h4 id="开发菜单权限"><a class="anchor" href="#开发菜单权限">#</a> 开发菜单权限</h4><ol><li>拆分路由</li></ol><ul><li>静态（常亮）路由：所有用户都可以访问的路由。（登录、首页、数据大屏、404）</li><li>异步路由：不同身份的用户有的有这个路由，有的没有</li><li>任意路由</li></ul><ol start="2"><li>菜单权限开发思路<br>目前咱们得项目：任何用户访问到的、能操作的菜单与按钮都是一样的</li></ol><p>过滤异步路由，map 递归生成菜单，</p><ul><li>路由器管理的只有常亮路由，用户计算完异步路由、任意路由后要动态追加：</li></ul><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span><span class="token operator">...</span>userAsyncRoute<span class="token punctuation">,</span> anyRoute<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">route</span><span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  router<span class="token punctuation">.</span><span class="token function">addRoute</span><span class="token punctuation">(</span>route<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><ul><li>导航守卫</li></ul><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token operator">...</span>to <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="数据大屏"><a class="anchor" href="#数据大屏">#</a> 数据大屏</h3><ul><li>适配问题：vw、vh； transform.scale (结合 js)<br><span class="exturl" data-url="aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMVhoNDExVjdiNS8/cD0xMjkmYW1wO3NwbV9pZF9mcm9tPXBhZ2VEcml2ZXImYW1wO3ZkX3NvdXJjZT1mZjI0Nzc3MmE2MmVlOWMzYjJlZDI3ZmE1ZTRhOTFlMg==">https://www.bilibili.com/video/BV1Xh411V7b5/?p=129&amp;spm_id_from=pageDriver&amp;vd_source=ff247772a62ee9c3b2ed27fa5e4a91e2</span><br>p129 22:09</li></ul><h3 id="项目上线"><a class="anchor" href="#项目上线">#</a> 项目上线</h3><h4 id="1-环境替换"><a class="anchor" href="#1-环境替换">#</a> 1、 环境替换</h4><h4 id="2-打包工作中一般前端就做到这把打包后的-dist-文件夹交上去就行了"><a class="anchor" href="#2-打包工作中一般前端就做到这把打包后的-dist-文件夹交上去就行了">#</a> 2、 打包（工作中一般前端就做到这，把打包后的 dist 文件夹交上去就行了）、</h4><h4 id="3-把-dist-上传到服务器-配置-nginx-代理"><a class="anchor" href="#3-把-dist-上传到服务器-配置-nginx-代理">#</a> 3、 把 dist 上传到服务器 - 配置 nginx 代理</h4><ol><li>连接服务器， <code>cd etc</code> 后安装 nginx： <code>yum install nginx</code></li><li><code>cd nginx</code> 后进行配置 <code>vim nginx.conf</code> :</li></ol><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre>user root<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>location <span class="token operator">/</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  root <span class="token operator">/</span>root<span class="token operator">/</span>www<span class="token operator">/</span>dist<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  index index<span class="token punctuation">.</span>html index<span class="token punctuation">.</span>html<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><ol start="3"><li>修改后重启： <code>systemctl restart nginx.service</code> , 随后项目便上线了</li></ol><div class="tags"><a href="/tags/%E5%AE%9E%E6%88%98/" rel="tag"><i class="ic i-tag"></i> 实战</a> <a href="/tags/%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/" rel="tag"><i class="ic i-tag"></i> 后台管理系统</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2023-11-07 11:37:02" itemprop="dateModified" datetime="2023-11-07T11:37:02+08:00">2023-11-07</time></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt=" 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.png" alt=" 支付宝"><p>支付宝</p></div><div><img data-src="/images/paypal.png" alt=" 贝宝"><p>贝宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong><i class="ic i-at"><em>@</em></i>Eucli の小窝</li><li class="link"><strong>本文链接：</strong> <a href="https://eucli.top/2023/10/11/%E7%A1%85%E8%B0%B7%E7%94%84%E9%80%89%E9%A1%B9%E7%9B%AE%E7%AC%94%E8%AE%B0/" title="硅谷甄选项目笔记">https://eucli.top/2023/10/11/硅谷甄选项目笔记/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2023/09/29/Node.js/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gipey0a334j20zk0m8qpt.jpg" title="Nodejs"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 后端</span><h3>Nodejs</h3></a></div><div class="item right"><a href="/2023/10/12/%E9%A1%B9%E7%9B%AE%E4%B8%8A%E7%BA%BF%E6%B5%81%E7%A8%8B/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1giclgi503lj20zk0m8hdt.jpg" title="项目上线流程"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> 前端</span><h3>项目上线流程</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#tips-vue3-%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1%E6%96%B9%E5%BC%8F"><span class="toc-number">1.</span> <span class="toc-text">tips： vue3 组件通信方式</span></a></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%A1%85%E8%B0%B7%E7%94%84%E9%80%89%E8%BF%90%E8%90%A5%E5%B9%B3%E5%8F%B0"><span class="toc-number"></span> <span class="toc-text">硅谷甄选运营平台</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-%E6%90%AD%E5%BB%BA%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E6%A8%A1%E6%9D%BF"><span class="toc-number"></span> <span class="toc-text">一、搭建后台管理系统模板</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#11-%E9%A1%B9%E7%9B%AE%E5%88%9D%E5%A7%8B%E5%8C%96-%E9%80%82%E7%94%A8%E4%BA%8E%E5%9B%A2%E9%98%9F%E5%BC%80%E5%8F%91%E5%9C%BA%E6%99%AF%E8%87%AA%E5%B7%B1%E7%9A%84%E9%A1%B9%E7%9B%AE%E4%B8%8D%E7%94%A8%E9%85%8D%E7%BD%AE%E7%9A%84%E9%82%A3%E4%B9%88%E9%BA%BB%E7%83%A6"><span class="toc-number">1.</span> <span class="toc-text">1.1 项目初始化 (适用于团队开发场景，自己的项目不用配置的那么麻烦)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-%E9%A1%B9%E7%9B%AE%E9%85%8D%E7%BD%AE"><span class="toc-number">2.</span> <span class="toc-text">1.2 项目配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#121-eslint-%E9%85%8D%E7%BD%AE"><span class="toc-number">2.1.</span> <span class="toc-text">1.2.1 eslint 配置</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1211-vue3-%E7%8E%AF%E5%A2%83%E4%BB%A3%E7%A0%81%E6%A0%A1%E9%AA%8C%E6%8F%92%E4%BB%B6"><span class="toc-number">2.1.1.</span> <span class="toc-text">1.2.1.1 vue3 环境代码校验插件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#12-%E4%BF%AE%E6%94%B9eslintrccjs-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">2.1.2.</span> <span class="toc-text">1.2 修改.eslintrc.cjs 配置文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#13eslintignore-%E5%BF%BD%E7%95%A5%E6%96%87%E4%BB%B6"><span class="toc-number">2.1.3.</span> <span class="toc-text">1.3.eslintignore 忽略文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#14-%E8%BF%90%E8%A1%8C%E8%84%9A%E6%9C%AC"><span class="toc-number">2.1.4.</span> <span class="toc-text">1.4 运行脚本</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8C-%E9%85%8D%E7%BD%AEprettier-vscode-%E5%A5%BD%E5%83%8F%E6%9C%89-pretter-%E6%8F%92%E4%BB%B6"><span class="toc-number">2.2.</span> <span class="toc-text">二、配置 prettier (vscode 好像有 pretter 插件)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#21-%E5%AE%89%E8%A3%85%E4%BE%9D%E8%B5%96%E5%8C%85"><span class="toc-number">2.2.1.</span> <span class="toc-text">2.1 安装依赖包</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#22prettierrcjson-%E6%B7%BB%E5%8A%A0%E8%A7%84%E5%88%99"><span class="toc-number">2.2.2.</span> <span class="toc-text">2.2.prettierrc.json 添加规则</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#23prettierignore-%E5%BF%BD%E7%95%A5%E6%96%87%E4%BB%B6"><span class="toc-number">2.2.3.</span> <span class="toc-text">2.3.prettierignore 忽略文件</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%89-%E9%85%8D%E7%BD%AE-stylelint-%E6%84%9F%E8%A7%89%E6%B2%A1%E5%BF%85%E8%A6%81"><span class="toc-number">2.3.</span> <span class="toc-text">三、配置 stylelint (感觉没必要)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#31stylelintrccjs%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">2.3.1.</span> <span class="toc-text">3.1 .stylelintrc.cjs 配置文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#32stylelintignore-%E5%BF%BD%E7%95%A5%E6%96%87%E4%BB%B6"><span class="toc-number">2.3.2.</span> <span class="toc-text">3.2.stylelintignore 忽略文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#33-%E8%BF%90%E8%A1%8C%E8%84%9A%E6%9C%AC"><span class="toc-number">2.3.3.</span> <span class="toc-text">3.3 运行脚本</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9B%9B-%E9%85%8D%E7%BD%AE-husky"><span class="toc-number">2.4.</span> <span class="toc-text">四、配置 husky</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%94-%E9%85%8D%E7%BD%AE-commitlint"><span class="toc-number">2.5.</span> <span class="toc-text">五、配置 commitlint</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%AD-%E5%BC%BA%E5%88%B6%E4%BD%BF%E7%94%A8-pnpm-%E5%8C%85%E7%AE%A1%E7%90%86%E5%99%A8%E5%B7%A5%E5%85%B7"><span class="toc-number">2.6.</span> <span class="toc-text">六、强制使用 pnpm 包管理器工具</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-%E9%A1%B9%E7%9B%AE%E9%9B%86%E6%88%90"><span class="toc-number"></span> <span class="toc-text">二、项目集成</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#21-%E9%9B%86%E6%88%90-element-plus"><span class="toc-number">1.</span> <span class="toc-text">2.1 集成 element-plus</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#22-src-%E5%88%AB%E5%90%8D%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="toc-number">2.</span> <span class="toc-text">2.2 src 别名的配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#23-%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="toc-number">3.</span> <span class="toc-text">2.3 环境变量的配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#24-svg-%E5%9B%BE%E6%A0%87%E9%85%8D%E7%BD%AE"><span class="toc-number">4.</span> <span class="toc-text">2.4 SVG 图标配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#241-svg-%E5%B0%81%E8%A3%85%E4%B8%BA%E5%85%A8%E5%B1%80%E7%BB%84%E4%BB%B6"><span class="toc-number">4.1.</span> <span class="toc-text">2.4.1 svg 封装为全局组件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#25-%E9%9B%86%E6%88%90-sass"><span class="toc-number">5.</span> <span class="toc-text">2.5 集成 sass</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#26-mock-%E6%95%B0%E6%8D%AE"><span class="toc-number">6.</span> <span class="toc-text">2.6 mock 数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#27-axios-%E4%BA%8C%E6%AC%A1%E5%B0%81%E8%A3%85"><span class="toc-number">7.</span> <span class="toc-text">2.7 axios 二次封装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#28-api-%E6%8E%A5%E5%8F%A3%E7%BB%9F%E4%B8%80%E7%AE%A1%E7%90%86"><span class="toc-number">8.</span> <span class="toc-text">2.8 API 接口统一管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#29-%E6%A8%A1%E6%9D%BF%E7%9A%84%E8%B7%AF%E7%94%B1%E9%85%8D%E7%BD%AE"><span class="toc-number">9.</span> <span class="toc-text">2.9 模板的路由配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#210-pinia-%E4%BB%93%E5%BA%93"><span class="toc-number">10.</span> <span class="toc-text">2.10 pinia 仓库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#211-login-%E8%B7%AF%E7%94%B1%E9%A1%B5%E9%9D%A2"><span class="toc-number">11.</span> <span class="toc-text">2.11 login 路由页面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#212-layout%E6%88%96-home%E8%B7%AF%E7%94%B1%E9%A6%96%E9%A1%B5"><span class="toc-number">12.</span> <span class="toc-text">2.12 layout (或 home) 路由首页</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#213-%E4%B8%AD%E9%97%B4%E5%86%85%E5%AE%B9%E5%B1%95%E7%A4%BA%E5%8C%BA%E5%9F%9F"><span class="toc-number">13.</span> <span class="toc-text">2.13 中间内容展示区域</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#214-%E9%A1%B6%E9%83%A8-tabbar-%E5%AF%BC%E8%88%AA%E5%8C%BA%E5%9F%9F"><span class="toc-number">14.</span> <span class="toc-text">2.14 顶部 tabbar 导航区域</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#215-%E8%B7%AF%E7%94%B1%E5%AE%88%E5%8D%AB%E8%B7%AF%E7%94%B1%E9%89%B4%E6%9D%83"><span class="toc-number">15.</span> <span class="toc-text">2.15 路由守卫 | 路由鉴权</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#216-%E6%8E%A5%E5%8F%A3"><span class="toc-number">16.</span> <span class="toc-text">2.16 接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#217-%E5%95%86%E5%93%81%E7%AE%A1%E7%90%86-%E5%93%81%E7%89%8C%E7%AE%A1%E7%90%86"><span class="toc-number">17.</span> <span class="toc-text">2.17 商品管理 - 品牌管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E9%9D%99%E6%80%81%E6%A8%A1%E5%9D%97%E6%90%AD%E5%BB%BA%E4%B8%8E%E6%A8%A1%E5%9D%97%E6%95%B0%E6%8D%AE%E5%B1%95%E7%A4%BA"><span class="toc-number">17.1.</span> <span class="toc-text">1. 静态模块搭建与模块数据展示</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-ts-%E7%B1%BB%E5%9E%8B%E5%AE%9A%E4%B9%89"><span class="toc-number">17.2.</span> <span class="toc-text">2. ts 类型定义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%88%86%E9%A1%B5%E5%B1%95%E7%A4%BA%E6%95%B0%E6%8D%AE"><span class="toc-number">17.3.</span> <span class="toc-text">3. 分页展示数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%AF%B9%E8%AF%9D%E6%A1%86-dailog-%E5%AF%B9%E8%AF%9D%E6%A1%86%E9%9D%99%E6%80%81%E6%90%AD%E5%BB%BA-%E6%B7%BB%E5%8A%A0%E4%B8%8E%E4%BF%AE%E6%94%B9%E5%93%81%E7%89%8C%E4%B8%9A%E5%8A%A1%E5%AE%9E%E7%8E%B0"><span class="toc-number">17.4.</span> <span class="toc-text">4. 对话框 dailog 对话框静态搭建 （添加与修改品牌业务实现）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#218-%E5%B9%B3%E5%8F%B0%E5%B1%9E%E6%80%A7%E7%AE%A1%E7%90%86"><span class="toc-number">18.</span> <span class="toc-text">2.18 平台属性管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%B9%B3%E5%8F%B0%E5%B1%9E%E6%80%A7%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97%E9%9D%99%E6%80%81%E6%90%AD%E5%BB%BA"><span class="toc-number">18.1.</span> <span class="toc-text">1. 平台属性管理模块静态搭建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%B1%9E%E6%80%A7%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97%E4%B8%80%E7%BA%A7%E5%88%86%E7%B1%BB%E6%95%B0%E6%8D%AE%E6%94%B6%E9%9B%86%E4%B8%8E%E5%B1%95%E7%A4%BA"><span class="toc-number">18.2.</span> <span class="toc-text">2. 属性管理模块一级分类数据收集与展示</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#219-spu-%E6%A8%A1%E5%9D%97"><span class="toc-number">19.</span> <span class="toc-text">2.19 SPU 模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E5%96%B5%E7%9A%84%E8%BF%99%E6%A0%B7%E6%95%88%E7%8E%87%E5%A4%AA%E6%85%A2%E4%BA%86%E8%B7%B3%E4%BA%86%E8%B7%B3%E4%BA%86"><span class="toc-number">20.</span> <span class="toc-text">特喵的这样效率太慢了，跳了跳了</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86-%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86"><span class="toc-number">21.</span> <span class="toc-text">权限管理 - 用户管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E9%9D%99%E6%80%81%E6%90%AD%E5%BB%BA"><span class="toc-number">21.1.</span> <span class="toc-text">1. 用户管理静态搭建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E5%B1%95%E7%A4%BA%E5%B7%B2%E6%9C%89%E8%B4%A6%E5%8F%B7%E6%95%B0%E6%8D%AE"><span class="toc-number">21.2.</span> <span class="toc-text">2. 用户管理展示已有账号数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%B7%BB%E5%8A%A0%E4%B8%8E%E7%BC%96%E8%BE%91%E4%BF%AE%E6%94%B9%E7%94%A8%E6%88%B7%E4%B8%9A%E5%8A%A1%E5%AE%9E%E7%8E%B0"><span class="toc-number">21.3.</span> <span class="toc-text">3. “添加” 与 “编辑”（修改）用户业务实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%88%86%E9%85%8D%E8%A7%92%E8%89%B2%E4%B8%9A%E5%8A%A1"><span class="toc-number">21.4.</span> <span class="toc-text">4. 分配角色业务</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86-%E8%A7%92%E8%89%B2%E7%AE%A1%E7%90%86"><span class="toc-number">22.</span> <span class="toc-text">权限管理 - 角色管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E9%85%8D%E6%9D%83%E9%99%90%E5%8A%9F%E8%83%BD"><span class="toc-number">22.1.</span> <span class="toc-text">分配权限功能</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86-%E8%8F%9C%E5%8D%95%E7%AE%A1%E7%90%86"><span class="toc-number">23.</span> <span class="toc-text">权限管理 - 菜单管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%80%E5%8F%91%E8%8F%9C%E5%8D%95%E6%9D%83%E9%99%90"><span class="toc-number">23.1.</span> <span class="toc-text">开发菜单权限</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%A4%A7%E5%B1%8F"><span class="toc-number">24.</span> <span class="toc-text">数据大屏</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E4%B8%8A%E7%BA%BF"><span class="toc-number">25.</span> <span class="toc-text">项目上线</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E7%8E%AF%E5%A2%83%E6%9B%BF%E6%8D%A2"><span class="toc-number">25.1.</span> <span class="toc-text">1、 环境替换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%89%93%E5%8C%85%E5%B7%A5%E4%BD%9C%E4%B8%AD%E4%B8%80%E8%88%AC%E5%89%8D%E7%AB%AF%E5%B0%B1%E5%81%9A%E5%88%B0%E8%BF%99%E6%8A%8A%E6%89%93%E5%8C%85%E5%90%8E%E7%9A%84-dist-%E6%96%87%E4%BB%B6%E5%A4%B9%E4%BA%A4%E4%B8%8A%E5%8E%BB%E5%B0%B1%E8%A1%8C%E4%BA%86"><span class="toc-number">25.2.</span> <span class="toc-text">2、 打包（工作中一般前端就做到这，把打包后的 dist 文件夹交上去就行了）、</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%8A%8A-dist-%E4%B8%8A%E4%BC%A0%E5%88%B0%E6%9C%8D%E5%8A%A1%E5%99%A8-%E9%85%8D%E7%BD%AE-nginx-%E4%BB%A3%E7%90%86"><span class="toc-number">25.3.</span> <span class="toc-text">3、 把 dist 上传到服务器 - 配置 nginx 代理</span></a></li></ol></li></ol></li></ol></li></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/2023/09/29/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AE%9E%E6%88%98/" rel="bookmark" title="微信小程序实战">微信小程序实战</a></li><li><a href="/2023/09/29/axios%E4%BA%8C%E6%AC%A1%E5%B0%81%E8%A3%85/" rel="bookmark" title="axios二次封装">axios二次封装</a></li><li><a href="/2023/09/29/TS%E7%99%BE%E7%BB%83%E9%A3%9E%E5%8D%87/" rel="bookmark" title="TS百炼飞升">TS百炼飞升</a></li><li><a href="/2023/09/29/%E3%80%90%E6%A1%88%E4%BE%8B%E3%80%91%E6%B3%9B%E5%9E%8B%E5%B0%81%E8%A3%85%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="bookmark" title="【案例】泛型封装数据库">【案例】泛型封装数据库</a></li><li><a href="/2023/09/29/%E4%BC%98%E9%9B%85JS/" rel="bookmark" title="优雅JS">优雅JS</a></li><li><a href="/2023/09/29/%E5%89%8D%E7%AB%AF%E8%87%AA%E5%8A%A8%E5%8C%96/" rel="bookmark" title="前端自动化">前端自动化</a></li><li><a href="/2023/09/29/%E5%B0%9A%E5%93%81%E6%B1%87%E5%89%8D%E5%8F%B0%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/" rel="bookmark" title="尚品汇前台项目实战">尚品汇前台项目实战</a></li><li class="active"><a href="/2023/10/11/%E7%A1%85%E8%B0%B7%E7%94%84%E9%80%89%E9%A1%B9%E7%9B%AE%E7%AC%94%E8%AE%B0/" rel="bookmark" title="硅谷甄选项目笔记">硅谷甄选项目笔记</a></li><li><a href="/2023/10/12/%E9%A1%B9%E7%9B%AE%E4%B8%8A%E7%BA%BF%E6%B5%81%E7%A8%8B/" rel="bookmark" title="项目上线流程">项目上线流程</a></li><li><a href="/2023/10/19/CSS/" rel="bookmark" title="CSS">CSS</a></li><li><a href="/2023/10/29/VueRouter/" rel="bookmark" title="VueRouter">VueRouter</a></li><li><a href="/2023/11/03/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" rel="bookmark" title="计算机网络">计算机网络</a></li><li><a href="/2023/11/05/JS%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" rel="bookmark" title="JS基础">JS基础</a></li><li><a href="/2023/11/05/%E5%BC%82%E6%AD%A5async%E3%80%81await/" rel="bookmark" title="异步编程">异步编程</a></li><li><a href="/2023/11/06/React%EF%BC%88%E7%8E%8B%E7%BA%A2%E5%85%83%EF%BC%89/" rel="bookmark" title="React（王红元）">React（王红元）</a></li><li><a href="/2023/11/06/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91%E6%89%A9%E5%B1%95/" rel="bookmark" title="前后端开发扩展">前后端开发扩展</a></li><li><a href="/2023/11/06/%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%EF%BC%9AVite%20+%20Vue3%20+%20Typescript%20+%20Pinia%20+%20Vueuse%E9%A1%B9%E7%9B%AE/" rel="bookmark" title="快速搭建：Vite + Vue3 + Typescript + Pinia + Vueuse项目">快速搭建：Vite + Vue3 + Typescript + Pinia + Vueuse项目</a></li><li><a href="/2023/11/07/TS%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%EF%BC%88coderwhy%EF%BC%89/" rel="bookmark" title="TS数据结构与算法（coderwhy）">TS数据结构与算法（coderwhy）</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="" data-src="/images/avatar.jpg"><p class="name" itemprop="name"></p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">25</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">4</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">21</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL21vbm9rdW1hMzEyMQ==" title="https:&#x2F;&#x2F;github.com&#x2F;monokuma3121"><i class="ic i-github"></i></span> <span class="exturl item about" data-url="aHR0cHM6Ly9hYm91dC5tZS9hbWVoaW1l" title="https:&#x2F;&#x2F;about.me&#x2F;amehime"><i class="ic i-address-card"></i></span> <span class="exturl item email" data-url="aHR0cHM6Ly9tYWlsLmdvb2dsZS5jb20vbWFpbC91LzAvI2luYm94" title="https:&#x2F;&#x2F;mail.google.com&#x2F;mail&#x2F;u&#x2F;0&#x2F;#inbox"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>友達</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2023/09/29/Node.js/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2023/10/12/%E9%A1%B9%E7%9B%AE%E4%B8%8A%E7%BA%BF%E6%B5%81%E7%A8%8B/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"></div><div class="status"><div class="copyright">&copy; 2021 – <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">@ Eucliの小窝</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">283k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">4:17</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2023/10/11/硅谷甄选项目笔记/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->